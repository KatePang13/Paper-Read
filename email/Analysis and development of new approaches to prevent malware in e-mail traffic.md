#  Analyse und Ausarb eitung neuer Ans√§tze zur Verhinderung von Schadsoftware im E-Mailverkehr

Hochschule der Medien Stuttgart

### Bachelorarbeit im Studiengang

### Medieninformatik

#### VorgelegtvonStephanTraub

#### Matrikelnummer 26813

#### zurErlangungdesakademischenGradeseines

#### BachelorofScience

#### am17.07.

#### Erstbetreuer: Zweitbetreuer:

#### Prof.Dr.MartinGoik Dipl.-Ing.BenjaminKenner

#### Ho chschulederMedien audiusGmbH


# Eidesstattliche Erkl√§rung

 Hiermitversichereich,StephanTraub,ehrenw√∂rtlich,dassichdievorliegendeBa-
chelorarb eitmitdemTitel:AnalyseundAusarb eitungneuerAns√§tzezurVerhin-
derungvonSchadsoftwareimE-Mailverkehrselbstst√§ndigundohnefremdeHilfe
verfasstundkeineanderenalsdieangegeb enenHilfsmittelb enutzthab e.DieStellen
derArb eit,diedemWortlauto derdemSinnnachanderenWerkenentnommenwur-
den,sindinjedemFallunterAngab ederQuellekenntlichgemacht.DieArb eitist
no chnichtver√∂entlichto derinandererFormalsPr√ºfungsleistungvorgelegtworden.
Ichhab edieBedeutungderehrenw√∂rtlichenVersicherungunddiepr√ºfungsrechtli-
chenFolgen (¬ü 26 Abs. 2 Bachelor-SPO(6Semester), ¬ü 24 Abs. 2 Bachelor-SPO
(7Semester),¬ü 23 Abs. 2 Master-SPO(3Semester)bzw.¬ü 19 Abs. 2 Master-SPO
(4Semesterundb erufsb egleitend)derHdM)einerunrichtigeno derunvollst√§ndigen
ehrenw√∂rtlichenVersicherungzurKenntnisgenommen.

StephanTraub Datum

```
i
```

```
Abstract
```
Over 90 p ercent of assaultson computer users issue froma simpleemail.Our
strongaddictiontothiscommunicationsystem,inbusinessenvironmentaswellas
inprivateshp ere,providesahugesurfaceformalwareattacks.Currentanti-malware
lterscan'tprovideasatisfactorytodetectionrateofthesemalware.Thispap er
describ esnewp ossibilitiesforadynamicrecognitionofthegrowingthreatinthe
emailtrac.Owingtothesenewapproaches,theysignicantlyincreasethedetec-
tionratesoftheemailltersofnewformsofmalware.Theenhancementforthis
newapproachesofb otheciencyandtheimproveddetectioniscurrentlyoutlined
againstltertechnologiesbymeasurements.Thisworkfo cusesonprevailingexisting
threatsrelatingtosmalltomidsizeemailinfrastructures.

```
Kurzfassung
```
√úb er90%derAngrieaufComputerb enutzerk√∂nnenaufeineE-Mailzur√ºckgef√ºhrt
werden.DurchdiestarkeAbh√§ngigkeitvondiesemKommunikationsmittel,sowohl
imb etrieblichenalsauchimprivatenUmfeld,bietetdieseineektivesEinfallstorf√ºr
Schadsoftware. AktuelleAnti-Malware-Filterk√∂nneninvielenF√§llenkeinezufrie-
denstellende Erkennungsratedieser Schadsoftwarebieten.DieseArb eitzeigtneue
M√∂glichkeiten zur dynamischenErkennungder stetig wachsendenBedrohung im
E-Mailverkehrauf.DurchdieseneuenAns√§tzewerdendieErkennungsratenderE-
MailltersignikantgesteigertundsoneueFormenvonSchadsoftwareverhindert.
DieSteigerungderEzienzunddieverb esserteErkennungwerdengegenaktuellein-
gesetzteFiltertechnologienmittelsMessungenverglichen.ImFokusstehenhieraktu-
ellb estehendeBedrohungenf√ºrkleinebismittelgro√øeE-Mail-Infrastrukturen.

```
ii
```

## Inhaltsverzeichnis

Abbildungsverzeichnis v

Tab ellenverzeichnis vii


- 1 √úb ersicht Abk√ºrzungsverzeichnis viii
   - 1.1 Zielsetzung
   - 1.2 Struktur
   - 1.3 StilderArb eit.
- 2 Einf√ºhrung
   - 2.1 Denitionen
   - 2.2 E-Mail
   - 2.3 AngrisvektorE-Mail.
   - 2.4 BeispieleinesAngrisablaufs.
      - 2.4.1 PraktischeBezugnahme
- 3 Ausgangslage
   - 3.1 Testumfeld.
   - 3.2 E-Mail-Filterung
      - 3.2.1 Metho den
      - 3.2.2 Vorgang
      - 3.2.3 Filtertechnologien.
   - 3.3 Messungen.
      - 3.3.1 Ergebnisse
      - 3.3.2 ZusammenfassungderMessungen
   - 3.4 DarstellungdesDezits.
- 4 NeueAns√§tze
   - 4.1 R√ºckschl√ºsseausdenMessergebnissen
   - 4.2 NeueWegederErkennung
      - 4.2.1 VerhinderungvonSpamdurchb ekannteAbsender.
      - 4.2.2 VerhinderungvonMakro-Malware.
- 5 Schlussb etrachtung
   - 5.1 VergleichzuanderenAns√§tzen.
   - 5.2 Zusammenfassung.
   - 5.3 Diskussion
   - 5.4 Weiterf√ºhrendeArb eit
   - 5.5 Danksagung
- Glossar
- Literatur


# Abbildungsverzeichnis

```
1 TeilmengendiagrammvonSpam.Quelle:Autor............. 4
2 PhishingE-Mail,b eiderversuchtwird,dieAnmeldedatenf√ºreinen
Bankzugangzuerhalten.Quelle:Wikip edia[52]............ 8
3 SpamE-MailmitMalwareimAnhang.Quelle:Autor......... 9
4 Domain-Abfrageb eimDomain-Registrar.Quelle:Autor........ 10
5 AngriskettederMalware.Quelle:Autor................ 12
6 EineAuorderungf√ºrdieL√∂segeldzahlungnachdererfolgreichenVer-
schl√ºsselung.Quelle:Wikip edia[51]................... 13
7 MeldungaufderFirmenwebseite,nachdemMalwarevondessenAb-
senderadresseversendetwurde.Quelle:Autor............. 13
8 √úb ersichtderMTAStrukturdesMesssystems.Quelle:Autor..... 17
9 FilterstrukturinnerhalbdesMesssystems.Quelle:Autor....... 18
10 Spam-KampagnenmitMalwarealsAnhang-Zeitraum23.04-23.05.2016.
Quelle:Autor............................... 22
11 AnzahlderE-MailsamMesssystemmitentsprechendenDateiendun-
gen.Quelle:Autor............................ 26
12 FilterungdesSpamassassin.Quelle:Autor............... 27
13 Spam-Rep ortvonSymantec.Quelle:Symantec[41].......... 28
14 F√ºrdenBenutzeroensichtlicheSpam-Nachricht.Quelle:Autor... 32
15 Konzeptf√ºrdieEinbindungderAbsenderdatenbank.Quelle:Autor. 35
16 VBA-Co deeinerMalware.Quelle:Autor................ 37
17 PositiondesMacroMiltersimE-Mailuss.Quelle:Autor....... 40
18 PositiondesMacroMiltersinderFilterkette.Quelle:Autor...... 41
```
```
v
```

19 Kombination des Amavisd-New undMacroMiltersf√ºr die zur√ºck-
gewiesenenE-MailsmitdenentsprechendenDateiendungen.Quelle:
Autor................................... 42
20 Anzahlder eindeutigenMalware-Dokumente amHoneyp ot-System
imMonatMai2016.Quelle:Autor................... 43
21 AnteildervomMacroMiltererkanntenMalware.Quelle:Autor.... 46

```
vi
```

# Tabellenverzeichnis

```
1 √úb ersichtderMesssysteme........................ 15
2 EmpfangeneNachrichtenimMesszeitraum................ 25
3 Aufteilungderzur√ºckgewiesenenNachrichten............. 27
4 AnzahlderlegitimenundMalwareDokumentenmitAuftretender
Funktionen................................ 38
5 AnsatzzurGewichtungderFunktionsaufrufeimMakro-Co de..... 39
```
```
vii
```

# Abk√ºrzungsverzeichnis

FBI FederalBureauofInvestigation

FQDN FullyQualiedDomainName

HTTP Hyp ertextTransferProto col

IT Informationstechnik

MDA MailDeliveryAgent

MIME Multipurp oseInternetMailExtensions

MTA MailTransferAgent

RBL Real-timeBlackholeList

RFC RequestForComments

SMTP SimpleMailTransferProto col

URI UniformResourceIdentier

VBA VisualBasicAccess

```
viii
```

# 1 √úbersicht

SeitderErndung derE-Mailw√§chstdieAnzahl anE-Mailadressen undt√§glich
versendetenNachrichten stetig.Heutzutage istesnicht mehrun√ºblich,dasseine
einzelnePersonmehrereE-Mailadressenb esitzt.Fastschonselbstverst√§ndlichhat
jederzumeistzweif√ºrdiejeweilsgesch√§ftlicheundprivateKommunikation.

Diese Beliebtheitundeb enso weite Verbreitung l√§sst siein den Fokusf√ºrmiss-
br√§uchlicheVerwendungr√ºcken.H√§ugwirdSchadsoftwarealsAnhango derLink
getarnteinerE-Mailangef√ºgt,umdiesesoanm√∂glichstvieleBenutzerzuvertei-
len.Durch diehoheAnzahlanNachrichten, diejederBenutzert√§glicherh√§lt,ist
eineautomatisierteFilterungunerl√§sslich.DieseFilterm√ºssenmaschinellb ewerten,
welchedieserNachrichtenderBenutzererhaltenm√∂ chteundwelchenicht.Umdie-
sefeineAbstimmungzunden,werdenunterschiedlicheFiltermetho denwieSpam-
o derAnti-Malware-Filtereingesetzt.TrotzdemEinsatzvonsolchenFilterkommt
esdenno ch zuInfektionenmitSchadsoftware, diesich alsE-Mailanhang getarnt
hatte.

### 1.1 Zielsetzung

DieseArb eitsollaufzeigen,welcheDeziteimHinblickaufdieVerhinderungvon
SchadsoftwareinnerhalbE-Mailinfrastrukturenmitbiszu 1000 Benutzernexistie-
ren.Genauerwerdenhierb eidieb eidenFiltermetho denderweitverbreitetenE-Mail-


FilterSpamassassin^1 undAmavisd-New^2 sowiedemE-MailserverPostx^3 b etrach-
tet.DurchdasAusarb eitenneuerAns√§tze,solldieErkennungsratederFiltersigni-
kantgesteigertundsoneueFormenvonSchadsoftwareinnerhalbdesE-Mailverkehrs
verhindertwerden.DerFokuswirdaufdieErkennungvonSpamsowiedieAnalyse
vonAnh√§ngengelegt.

Aneinempro duktivenSystemsollanhandeinesdirektenVergleichsvonMessungen
dieEzienzderAns√§tzeaufgezeigtwerden.

### 1.2 Struktur

Zun√§chstsolleineBasisanVerst√§ndnisgeschaenundderProblemb etrachtungver-
mitteltwerden.Imn√§chstenSchrittwerdendieb estehendenAngrisvektorenderE-
Mail,dief√ºrdieseArb eitalsrelevantb etrachtetwerden,b estimmt.Zus√§tzlichwird
inKapitel 3 einStandardf√ºreinMessverfahrendeniert,derf√ºrdieBestimmung
derAusgangssituationherangezogenwird.DurchdieAnalyseundAufarb eitungder
Messergebnissek√∂nnenb estehendeDeziteerkanntundevaluiertwerden.MitHil-
fedieserErgebnissesolldurchdieOptimierungundAnwendungneuerAns√§tzein
Kapitel 4 eineVerb esserungderErkennungsratevonSpamundSchadsoftwareim
E-Mailverkehrerreichtwerden.

### 1.3 StilderArb eit.

Vieleder aufgef√ºhrtenQuellensind inenglischer Spracheverfasst.Beruhendauf
derEtablierungvonenglischenBegrieninderITwurdendieseinderArb eitnicht
√ºb ersetzt.H√§ugw√ºrdehiereine√úb ersetzungnichtzurVerst√§ndlichkeitdesTex-
tesb eitragen.EntsprechendeErl√§uterungensindf√ºrthemensp ezischeBegrieim
Glossarzunden. Firmen-,Pro dukt-sowieSoftwarenamenwerdenkursiv kennt-
lichgemacht.Zus√§tzlichwirdb eiderNennungvonSoftwareaucheineFu√ønotemit
derentsprechendenWebseiteangegeb en.Programmco des,Kongurationsparameter
o derDateipfadewerdeninmono-typekenntlichgemacht.

(^1) https://spamassassin.apache.org/
(^2) https://www.ijs.si/software/amavisd/
(^3) [http://www.p](http://www.p) ostx.org/


## 2 Einf√ºhrung

Grundlegend m√ºssenzun√§chst Begriichkeiten, die eine zentrale Rolle indieser
Arb eitspielen,b eschrieb enwerden.NursokanneineingehendesVerst√§ndnisf√ºrdie
Thematikvermitteltwerden.Zus√§tzlichwerdendieexistierendenAngrisvektoren
innerhalbeinesE-Mailverkehrsaufgezeigt.HierzusindindiesemKapitelmehrere
realeundgenutzteAngrisartenviaE-Maildargestellt.

### 2.1 Denitionen

Schadsoftware:Hierb eihandeltessichumProgramme,diemeistmiteinemkri-
minellenHintergrundeinwickeltwurden.InnerhalbderArb eitwirdderFokusauf
dieSchadsoftwaregelegt,dieviaE-Mailverteiltwird.

ImUmfeldderArb eitwirddasenglischeAkronym Malware(malicioussoftware)
alsSynonymf√ºrSchadsoftwareverwendet.SchadsoftwareundMalwaresindgleich-
b edeutendzub etrachten.

Spam:EinegenaueDenitionvonSpamistschwierigzuerfassen.Verallgemeinert
wirdSpamalsunerw√ºnschteundungewollteE-Mailb ezeichnet.Zumeisthandeltes
sichumNachrichten,dievomBenutzernichterwarteto dervonihmnichtinVer-
bindungmiteinemVorganggebrachtwerdenk√∂nnen[7,S.8].EinBeispielw√§rehier
WerbungeinesOnline-Shops,b eidemderBenutzerjedo chno chnieeingekaufthat.
DesweiterenkannSpamaucheinenp ornographischeno derkriminellenHintergrund
hab en.

InnerhalbderArb eitwirdderVerbreitungswegvonSchadsoftwaredurchE-Mailsb e-


trachtet.Hierb eiwirdSpamalsTransp ortmittelderSchadsoftwaredeniert.Somit
ergibtsicheineVerkettungzwischenderVerhinderungvonSpamundMalware.Wird
eineNachrichtaufgrundihrerEigenschaftenschonalsSpamerkannt,isteineKlas-
sizierungdesAnhangesdurcheinenMalware-Scannernichtmehrnotwendig.

```
Abbildung1:TeilmengendiagrammvonSpam.Quelle:Autor
```
WieinAbbildung 1 zusehenist,f√ºhrteineErkennungvonSpamdieVermeidung
vonMalwareherb ei,daMalwareeineTeilmengederSpam-Nachrichtenist.

DurchdieseKapselungderInhalte,entstehteineArtKettemitfolgendenSchrit-
ten:

```
1.Wird dieE-MailaufgrundderVerbindungsinformationenalsSpamerkannt,
isteinegenauereAnalysedesAnhangeso derE-Mailtextesnichtmehrn√∂tig.
2.Wirdjedo chdieNachrichtnichtimerstenSchritterkannt,musseineAnalyse
desTextesaufSpam-Musterdurchgef√ºhrtwerden.
3.ErbringenallevorherigenSchrittekeineKlassizierung,mussderAnhangex-
plizitaufVerhaltens-undInhaltsmustervonMalware√ºb erpr√ºftwerden.
```

### 2.2 E-Mail

ImJahr 2015 b eliefensichdieaneinemTagversendetenE-Mailsauf205,6Milliar-
den,wob ei112,5MilliardenimArb eitsumfeldempfangenundgesendetwurden[43,
S.4].DasaufdemSimpleMailTransferProto col(SMTP)basierendeKommunika-
tionsmittelistmituntereindesammeistengenutztenMediumszur√úb ermittlung
vonNachrichten.

Dadurch,dassdieE-MaileinzentraleKomp onentedert√§glichenKommunikation
darstellt,sind die verarb eitendenInfrastrukturen miteiner hohenAnzahl an E-
Mailob jektenkonfrontiert.HierstelltsichdieHerausforderung,dielegitimenHam-
E-MailsvonungewolltemSpamzuunterscheiden.DasZielmusssein,dieAnzahlan
Spam-Nachrichten,dief√§lschlicherweisealsHamerkanntwurden(False-Positiv),so
geringwiem√∂glichzuhalten.AufderanderenSeitedarfdieFalse-Negativ-Ratenicht
steigen.DieseRaterepr√§sentiertdieAnzahlderE-Mails,dieSpamo derMalware
enthaltenab erdenno chandenBenutzerzugestelltwurden.Hierb eikonntendiese
nichtvondenFilterinstanzenalssolcheerkanntwerden.

Grunds√§tzlichwirdeineh√∂hereFalse-Negativ-RateinKaufgenommen.DerBenut-
zererh√§ltzwardieSpam-E-MailinseinemPostfach,kannsiedannab erb eiBedarf
l√∂schen.WenndieFalse-Positiv-Rateab er zuho chist,b ekommt derBenutzerle-
gitimeE-Mailsnichtmehr.Beident√§glichempfangenenMengenanNachrichten,
k√∂nntehierb ereitseineleichteErh√∂hungderb eidenRatenschontausendeE-Mails
b etreen.

Bezug genommenauf dieseArb eit, das jede Spam-NachrichtauchMalware ent-
halten kann,m√ºssen die Ratenweiter aufgeschl√ºsseltwerden. Wird eine h√∂here
False-Negativ-Rateb eiderMalware-Filterungeingesetzt,b estehteineh√∂hereWahr-
scheinlichkeit,dassderBenutzerMalwareinnerhalbderE-Mailerh√§lt.IneinerBe-
trachtungaufdieVerhinderungvonMalware,w√ºrdeeineh√∂hereFalse-Positiv-Rate
einenb esserenEekterzielen,dadurch strikteresZur√ºckweisenvonNachrichten
dasGefahrenp otentialjederE-Mailsinkt.

Die E-Mailselbstenth√§lt neb endem Absender,Empf√§ngerunddem E-Mailtext
auchweiteref√ºrdieFilterungwichtigeMetainformationen.AlleInformationenwer-
deninnerhalbdesMIME-BaumsderNachrichtgesp eichert.DieRFC 2822 b estimmt
hierb ei,inwelcherFormdieseInformationenangegeb enwerdenm√ºssen[37,S.5].


EineM√∂glichkeit,diesenBaummiteigenenKnotenzuerweiternumweitereInfor-
mationen√ºb erdieE-Mailzuhinterlegen,istgegeb en.DieseKontenwerdeninner-
halbeinerNachrichtalsMIME-Headero derE-Mail-Headerb ezeichnet.ImFalleder
E-Mail-FilterwirddieErweiterungsm√∂glichkeitderE-Mail-Headergernef√ºrdieAn-
gab ederKlassizierungeinerE-Mailverwendet.Somitkannz.B.eineSpam-E-Mail
√ºb er einenEintragin denMIME-Baum alssolcheklassiziert werden. Alle sp√§-
terenFilterinstanzenundBenutzeranwendungenk√∂nnendieseWerteauslesenund
eventuellneuezusetzen.

Listing2.1:E-MailheadereinerlegitimenE-MailmitMetainformationen.
Received: f r o m< entfernt>
Received: b y< entfernt>
XX‚àí‚àíSpamSpam‚àí‚àíF l a gStatu:sNO: No, score=‚àí0. 5 required= 5. 0
XX‚àí‚àíSpamSpam‚àí‚àíC h e c k e rTests:‚àíBAYES_00 =Version:‚àíS p a m A s s a s s i n1. 9,DKIM_SIGNED = 0. 1 3. 4. 0 ( 2 0 1 4, DKIM_VALID=‚àí0 2‚àí0 7 )‚àío n0. 1< e,DKIM_VALID_AU=ntfernt> ‚àí0. 1,
RCVD_IN_MSPIKE_H3=‚àí1. 5,RCVD_IN_MSPIKE_WL=‚àí0. 0 1

XX‚àí‚àíSpamSpam‚àí‚àíRBL :T i m i n g< d n s: to: (^4) t (^9) a.l (^21) 3 8 8 0. (^14) ms 6 .‚àí 62 .rew lad.m_saciolsrpeoiknely._n e t >conf[ig (^12) : 70. (^0). 9. 70. (^1) ( (^80) .] 3 %),
signal _user_changed: 1. 77 ( 0. 5 %), parse: 0. 72 ( 0. 2 %),
X‚àíe x t r a c t _ m e s s a g e _ m e t a d a t aSpam‚àíR e m o t e H e l o:< entfer:nt1 3>(^3.^4 %), get_uri_detail_list:^4.^9 (^1.^3 %)
X‚àíSpam‚àíRelaysUntrusted: <entfernt>
XR‚àíeV i r u sceive‚àídS c a n n e d:< entfe:r< ent>ntfernt>
F r o m:< entfernt>
ToSu:bj< eecntt:fe< ernntt>fernt>
D a t e:< entfernt>
M e s s a g eReferen‚àícI Des::< e< ennttffeerrnntt>>
I n‚àíR e p l y‚àíTo:< entfernt>
A c c e p tC o n t e n t‚àí‚àíL a n g u a g eL a n g u a g e::e ne n‚àíGB ,‚àíUSd e‚àíDE , e n‚àíUS
C o n t e n t‚àíT y p e: text/plain; charset="iso‚àí8 8 5 9‚àí1 "
MIMEC o n t e n t‚àíVe‚àírTsiroann:sfe 1 r.‚àí 0 E n c o d i n g: q u o t e d‚àíprintable
R e t u r n‚àíP a t h:< entfernt>
ImListing2.1isteinsolcherMIME-BaummitdenentsprechendenMetainforma-
tionenzusehen.Hiersindalle,vomSpam-o derMalware-Filterhinzugef√ºgteFelder
miteinemX-gekennzeichnet.Dieseb eschreib endieerfolgendenFiltermetho denmit
ihrenErgebnissenf√ºrdieseNachricht.Sokannz.B.√ºb erdieAuswertungdesFeldes
X-Spam-StatuseinE-MailprogrammdiesesofortalsSpamerkennen.


### 2.3 AngrisvektorE-Mail.

DieE-Mailbildetin91%allerAngriedenersteKontaktpunktzumOpfer[21,S.
3]. 30%allerEmpf√§ngerlesenE-Mailsmitangeh√§ngterSchadsoftwareo der einer
Verlinkungaufdiese.Hiervon√∂nen12%dieangeh√§ngteno derverlinktenMalware-
Programmeundf√ºhrendieseaus[49,S.18].

Wie b eschrieb en,werden Linksauch gernef√ºrdie Verbreitung vonMalwarege-
nutzt. DerBenutzerwirdauchhierdazuverleitet,auf diesenzuklicken umauf
eine Webseitemitintegriertem Malware-Downloadgeleitet zuwerden[35,S.5f].
ImschlechtestenFallwirddieMalwaredurcheineb estehendeSicherheitsl√ºckeim
BrowseraufdemSysteminstalliert.DerBenutzerb ekommthiervonnichtsmit.Um
eineh√∂hereWahrscheinlichkeitf√ºreineerfolgreicheInfektionzub ekommen,werden
h√§ugLinksundAnh√§ngerkombiniertineineSpam-E-Mailintegriert.

DerTelekommunikationskonzernVerizonhatb eieinerAnalyseimJahr 2015 festge-
stellt,dassdieE-Maileinesderamh√§ugstenverwendetenTransp ortmittelist,um
MalwaredemUserzu√ºb ermitteln[49,S.46].Hierausresultiert,dassdieE-Mailei-
nederwichtigstenVerbreitungswegef√ºrSchadco deist.Diesunterstreichtno chmals
dieWichtigkeitderFiltermetho deninnerhalbderE-Mailinfrastrukturen,umsolche
Angriezuunterbinden.

DieserTrendkannschonseiteinigerZeitb eobachtetwerden.Gr√ºndef√ºrdiewach-
sendeZahlanAngrienviaE-Mailsind,dassSchwachstellenineinenComputerein-
zudringen,nichtmehrsoeinfachauszunutzensind.DurchschnellereUp date-Zyklen
f√ºrSicherheitspatchesundst√§rkereVerschl√ºsselungeninnerhalbvonNetzwerkpro-
tokollenr√ºcktderMenschimmerweiterindenFokus,alsSchwachstellemissbraucht
zuwerden[15,S.2].DieM√∂glichkeiten,MalwareinAnh√§ngenundLinkszuintegrie-
ren,bietetdieE-MaileineinteressantePlattformzurVerbreitung.Durchtrickreiches
FormulierenundFormatiereneinerNachricht,kannderBenutzerzus√§tzlichzueiner
ungewolltenAktion,dasAusf√ºhrenderMalware,gedr√§ngtwerden.

√úb er die E-Mailwirdnicht nur Schadco de verteilt,sondern auchversucht,vom
BenutzervertraulicheDatenabzugreifen.Hierb eihandelt essich zumeistumZu-
gangsdatenf√ºrOnline-Shops,E-Mailp ostf√§chero derwieinAbbildung 2 gezeigtzu
einerBank.GibtderBenutzeraufdergef√§lschtenWebseiteseineZugangsdatenein
undversucht sichsoanzumelden,erh√§ltderAngreiferalleeingetragenDatenwie


Passw√∂rtero derBenutzernamen.DieseUnterformvonSpamwirdPhishinggenannt
ab er innerhalbdieserArb eitnicht weiterb eleuchtet,dahierdurch keineMalware
verbreitetwird.

Abbildung2:PhishingE-Mail,b eiderversuchtwird,dieAnmeldedatenf√ºreinen
Bankzugangzuerhalten.Quelle:Wikip edia[52]

EinweitererPunktist,dassesinnerhalbeinerE-MailkeinerleiIntegrit√§tssicherheit
gibt.Dashei√øt,dasseinEmpf√§ngerzukeinerZeitsichergehenkann,dassderan-
gezeigteAbsenderauchderist,derdieE-Mailversendethat[33,S.9f].Indiesem
FallkannnurderEmpf√§ngerselbstevaluieren,oberdenInhaltderE-Mailmitdem
AbsenderinVerbindungbringenkann.EineserverseitigeEvaluierungdesAbsenders
wirdnurrundvonderH√§lftederAlexaTopMil lionDomains^1 durchgef√ºhrt[12,S.
1].ImFallevonKleinstsystemenimmittelst√§ndischeno derprivatenBereichistdie
Zahlno chgeringereinzusch√§tzen.

GrundlegendbildetdieE-MaildurchdiefehlendeIntegrit√§tssicherheitunddieweite
Verbreitung einesehrgro√øeAngris√§che.DieFlexibilit√§tundderweitreichende
FunktionsumfangdesInhaltseinerE-Mailmachenesschwerf√ºrFiltersysteme,Spam
undMalwarevonlegitimenNachrichtenzuunterscheiden.

(^1) [http://www.alexa.com/topsites](http://www.alexa.com/topsites)


### 2.4 BeispieleinesAngrisablaufs.

InvielenF√§llenb eginntderAngrimiteinervermeintlichlegitimenE-Mailanden
Empf√§nger.H√§ugwerdeng√§ngigeThemenwieeineRechnungsstellungo derMah-
nungenalsVorwandverwendet.DieseInhaltesindnichtnurf√ºrjedenEmpf√§nger
ausersterSichtlegitim, sondernvermittelnaucheinegewisseBrisanz.Dieserdi-
gitalisierteVorgangistheutzutagezudemb eieinerpapierlosenRechnungsstellung
vollkommen√ºblich.

```
Abbildung3:SpamE-MailmitMalwareimAnhang.Quelle:Autor
```
Abbildung 3 zeigteinesolche E-MailmiteinemMalware-Anhang.F√ºreinenun-
b edarftenBenutzeristeshiernichtersichtlich,dassessichb ei demAnhangum
Schadsoftwarehandeln muss.DieserAnhangwirdh√§ugdurcheinMicrosoftOf-
ce Dokumentrepr√§sentiert.Esstellenf√ºrdiemeistenBenutzereinenvertrauten
Dateitypdar.H√§ugwerdenhierMicrosoftWordo derMicrosoftExcelDokumente
verwendet[34,S.19].


UmdieVertraulichkeitzuerh√∂hen,wirdinvielenF√§llenderAbsenderderE-Mail
vomMalware-Versendergef√§lscht.SomitkanneineBetrachtungdesAbsenderskei-
nenR√ºckschlussaufdieEchtheitderNachrichtgeb en.Selbstf√ºreinenerfahrenen
Benutzeristesfastunm√∂glichzuermitteln,obessichwirklichumeineF√§lschung
handelt.BeispielsweisezeigtdieAbfragedesDomain-Inhab ersindiesemFallauch
keinverd√§chtigesErgebnis,wieinAbbildung 4 zusehenist.DerInhab eristhierb ei
wirklicheinelegitimeFirma.

```
Abbildung4:Domain-Abfrageb eimDomain-Registrar.Quelle:Autor
```
DemreintextlichenInhaltderE-Mailistsomitkeineb √∂sartigeEigenschaftzuzu-
schreib en.ImFalldesAnhangso derLinkswirddieSch√§dlichkeiterstnachgenauerer
Analysesichtbar.

ImOptimalfallwirddieDateib eimAbsp eichernaufdemRechner desBenutzers
schon durchden lokalenVirenscannererkannt.Durchdieschnelle Abwandlungen
der Schadsoftware durch die Entwickler unddie zumeist nur einmal t√§glichak-
tualisierten Malware-Scanner, kann eine Erkennungdes Scanners ausbleib en.Im
schlimmstenFallistkeinMalware-ScanneraufdemZielrechnerinstalliert.Eineser-
verseitige√úb erpr√ºfungschl√§gtinvielenF√§llenausdenselb enGr√ºndenfehl(siehe
Kapitel3.2.3).

Die eigentliche Gefahrgeht imFalle der MicrosoftOce Dokumente nicht vom
Dokumentselbstaus,sondernvonderM√∂glichkeit,einMakro-Co dehinzuzuf√ºgen.
Urspr√ºnglichwarenundsinddieseMakrosindenDokumentef√ºrErweiterungenge-
dacht,dievomVerarb eitungsprogrammselbstnichtb ereitgestelltwerden.Sokann
mitVisualBasicAccess(VBA)einProgrammco deangef√ºgtwerdenundsoerwei-


terte Funktioneninnerhalb des Dokumentsverwendetwerden. Durch die gro√øen
FunktionsumfangvonVBAbietetdiesnat√ºrlichaucheinengro√øenAngrisvektor
undM√∂glichkeitenf√ºrMalware-Entwickler,Schadco dedirektindasDokumentein-
zub etten.

Durch Analysewerkzeugewiedem Oce MalwareScanner^2 vonFrankBoldewin,
kann dasDokument inseineBestandteilezerlegenwerden.Durch dieseVerarb ei-
tungwirdb eieinemMicrosoftOceDokumentderVBA-Co devomrestlichenText
getrennt.SomitwirddieM√∂glichkeitgeschaen,denCo dezuanalysieren,ohnedas
Dokument√∂nenzum√ºssen.

Die eigentliche Analyse derCo de-Funktionen stelltsich invielenF√§llenals sehr
schwerheraus.Grunds√§tzlichwirdvondenMalware-Entwicklernversucht,dieei-
gentlicheFunktionstarkzuverschleiern[8].DurchKonvertierungsowieVerschacht-
lungenvonFunktionenundCo de-Teilenwirdhierversucht,einenH√∂ chstgradan
Verschleierungzuerzeugen[26]und[30,S.6f].DiesesVorgehensolldieErkennung
b eieinemaufPatterno derHeuristikenbasierendenAnti-Malware-Filterunterbin-
den.

Der Makro-Co de selbstbildet nur eineArt Zwischenh√§ndler o der auchDropp er
genannt[18,S.82].DieserinziertdasSystemundl√§dtdanachvoneinemanderen,
imInternetstehendenSystem,eineweitereSchadsoftwarenach[30,S.8].Diesewird
dannaufdemRechnerausgef√ºhrtundstelltsomitdensch√§dlichenTeilderMalware
dar. Fallsdieser VorgangErfolghat, istder RechnermitSchadsoftwareinziert.
Abbildung 5 zeigtdengesamtenAngrisverlaufinseineneinzelnenSchritten.

IndenJahren 2015 und 2016 wurdenaufdiesemWegh√§ug Erpresser-Software,
auchRansomwaregenannt,verteilt.Hierb eihandeltessichumMalware,dieDaten
aufeineminziertenRechnermiteinerstarken Verschl√ºsselungverschl√ºsseltund
siesozun√§chstunbrauchbarmacht[2,S.7].DasOpferwirdnachdererfolgreichen
Verschl√ºsselungseinerDatendannzurBezahlungeinesGeldb etragsaufgefordert.
NachdemderErpresserdiesenBetragvomOpfererhaltenhat,wirdderEntschl√ºs-
selungsvorgangvomMalware-EntwicklereingeleitetunddasSystemdurchdiesen
Vorgangwiederverwendbargemacht[14,S.87].

(^2) [http://www.reconstructer.org/co](http://www.reconstructer.org/co) de.html


```
Abbildung5:AngriskettederMalware.Quelle:Autor
```
#### 2.4.1 PraktischeBezugnahme

InvielenF√§llenhateineInzierungmitRansomwareverheerendeFolgen.InBerich-
tenausMedien,sindhierb eidurchdieKampagnenderMalware-Entwicklereinige
√∂entlichenStelleninziertworden[22].Dadurch,dassdieRansomwareinvielen
F√§llenf√ºrdenArb eitsablaufwichtigeDatenverschl√ºsselte,wurdeauchh√§ugdas
vomMalware-EntwicklergeforderteL√∂segeldb ezahlt[6].

DerEinsatzeinerL√∂segeldforderungmachtdieseArtderKriminalit√§tsehrlukrativ.
DurchdieeinfacheVerbreitungsm√∂glichkeitviaE-Mailunddernahezuanonymen
ZahlweiseviaBitCoinbietetsichhiereineidealePlattform.LauteinerHo chrechnung
des Forb es[17] unddes Cisco TalesSecurityTeams [27], kann eineKampagnen
innerhalbeinesTagesbiszu1.093.590$(1BitCoin= 419 $-Kursam02.03.2015)
erwirtschaften. Das FBIermittelte von April 2014 bis Juni 2015,dassErpresser
Wertevonrund 18 MillionenUS-Dollareingenommenhab en[16].

Durch dieM√∂glichkeit, solchimmenseSummenerreichenzuk√∂nnen,hatsichein
neuesGesch√§ftsmo dellentwickelt,womitauchdieAnzahlundundProfessionalit√§t


Abbildung6:EineAuorderungf√ºrdieL√∂segeldzahlungnachdererfolgreichenVer-
schl√ºsselung.Quelle:Wikip edia[51]

derKampagnensteigt.DieseEntwicklungzeigtsichauchinDeutschland,b eider
nichtnurimNamenvonlegitimenundexistierendenFirmendieErpresser-Malware
versendet,sondernaucheinImageschadenf√ºrdieFirmaselbstentsteht(sieheAb-
bildung7).

Abbildung7:MeldungaufderFirmenwebseite,nachdemMalwarevondessenAb-
senderadresseversendetwurde.Quelle:Autor

NichtnurderSchadenf√ºrdieReputation derFirmaist enorm,sondernauchdie
r√ºckl√§ugenAntwortenvonEmpf√§ngernsindhiernichtzuverachten.Innerhalbei-
nerSpam-Kampagnenk√∂nneneinigetausendE-Mailsversendetwerden.Diesf√ºhrte
b ereitsineinemFallzuunz√§hligenAnrufeb eiderFirmenzentrale[13].Sokannein
AngreifernichtnurseineMalwareverteilen,sondernauchdenvermeintlichenAb-
senderempndlichsch√§digen.Gegenma√ønahmensindhiernahezuunm√∂glich.


## 3 Ausgangslage

### 3.1 Testumfeld.

InnerhalbderArb eitwirdregelm√§√øigBezugaufZahlenausdemBetriebsalltageines
E-Mailserversgenommen.Hierb eihandeltessichumeinpro duktivenMailserver,der
t√§glichf√ºrdenNachrichteneingangverwendetwird.

Zub eachtenist,dassdieEigenschaftendesE-Mailverkehrsstarkvonunterschied-
lichstenFaktorenabh√§ngenk√∂nnenundeinerstarkenVarianzausgesetztsind.Die
ermitteltenZahlenstellenalsoeinensp eziellenFalldar.Sielassenjedo chTenden-
zenundR√ºckschl√ºssezu,b estimmenab erkeineallgemeing√ºltigenVerhaltensmus-
ter.

AlleMesswertesindimBezugaufdasgenanntenMesssystemzub etrachten.Eine
gro√ø√§chigeAnalyseundeinVergleichderZahlenmitanderenSystemenistindieser
Arb eitnicht angedacht.Umeinerepr√§sentativeErgebniszuerhalten,werdendie
ermitteltenZahlen gegenverf√ºgbare undvergleichbareStatistiken gepr√ºft.Diese
werdenandenentsprechendenStellenreferenziert.

Pro duktivesSystem

Beidemverwendeten MesssystemhandeltessichumeinaktuellesLinux System
derDistributionUbuntu^1 inderVersion14.04LTS,dasdieinTab elle 1 gelisteten
ServicesundFilterinstallierthat.DasSystemb edientrund 753 Empf√§ngerf√ºr 16

(^1) [http://www.ubuntu.com/](http://www.ubuntu.com/)


Domains.ImMonatwerdenhiereingehendrund107.000E-Mailsverarb eitet,was
einJahresvolumenvonca.1.284.000darstellt.

```
Service Version Beschreibung
```
```
p ostx 2.11.0 Einfreiverf√ºgbarerMailServer,
der unter Linux/Unix erh√§ltlich
ist.
```
```
amavisd-new 2.7.1(20120429) DieserServicebieteteineSchnitt-
stelle f√ºr weitere Filtersysteme
an. Im Messsystem wird hier-
durchder VirenscannerClamAV
eingebunden.Zus√§tzlichbieteter
no ch die M√∂glichkeit, ohne ei-
ne Inhalts√ºb erpr√ºfung durchzu-
f√ºhren, gewisse Dateiendung zu
blo ckieren.DerServicewurdeals
Milterimplementiert.
```
```
ClamAV 0.89.1 AlsMo dulamAmavisd-Newan-
geh√§ngte Virenscanner. Dieser
pr√ºft dieAnh√§nge auf b ekannte
Viren-PatternundHeuristiken.
```
```
Spamassassin 3.4.0 Hierb eihandeltessichumeinen
weit verbreiteten Spam-Filter,
der durch diverse Filter- und
Erkennungsmetho den Spam von
Hamunterscheidenkann.
```
```
Tab elle1:√úb ersichtderMesssysteme
```
Honeyp ot-System

Zus√§tzlichzumpro duktivenSystem,wirdzurErmittlungvonverschiedenenMetain-
formationenno cheinHoneyp otverwendet.DiesesSystemnimmtjedeanihngesen-
deteNachrichtan.Filtermetho denwerdenhierb einichtangewendet.DasHoneyp ot-
SystemdientnurzurErfassungvonSpamundp otentiellerMalware-Dateien.Diese
Dateienwerdenf√ºrsp√§tereAnalysenherangezogen.


BeiderInstallationdiesesSystems,wurdeaufdiegleicheUbuntu Versiongesetzt,
wiediedespro duktiven.DasVolumenamHoneyp ot,miteinerkonguriertenTest-
Domain,liegtimDurchschnittb ei7.800E-MailsamTag,wasca.93.600imJahr
entspricht.

### 3.2 E-Mail-Filterung

UmeineAussage√ºb erangewendetenMessungenzugeb en,isteszun√§chstnotwendig
denMessaufbauzub eschreib en.DieserbildetdieGrundlagef√ºrdiesp√§terdurch-
gef√ºhrtenAnalysenundsollalsBasishierf√ºrdeniertwerden.Zun√§chstm√ºssendie
etabliertenundempfohlenenMa√ønahmenzurVerhinderungvonSpamundMalwa-
reimE-Mailverkehrb etrachtetwerden.ImDetailwerdendieFunktionenderfreien
Anti-Viren-SoftwareClamAV^2 sowiedesfreiverf√ºgbarenAnti-Spam-FiltersSpamas-
sassin inVerbindungmitdemeb enfallsfreienMailTransferAgent(MTA)Postx
b etrachtet.AlleKomp onentenwerdenh√§ugeingesetztundbildenimVerbundein
weitverbreitetesE-Mail-undFiltersystem.

#### 3.2.1 Metho den

UmdieunterschiedlichenSchrittederAnnahmeeinerE-Mailsb esserdarzustellen,
wurdendiesehierinAbschnitteunterteilt.JederstelltdieM√∂glichkeitdesEinsatzes
einesentsprechendenFiltersdar.InwelcherAuspr√§gungundRestriktivegeltert
wird,entscheidetder Serverb etreib erselbst.Hiergiltjedo chauchderGrundsatz,
dasssowenigSpamwiem√∂glichundsovielelegitimeE-Mailswiem√∂glich,√ºb ermit-
teltwerden.

- Verbindungsaufbau:InnerhalbdieseSchritteswirdgepr√ºft,obdieankom-
    mende Verbindung eine valideAbsender-Domain b esitzt. Valide hei√øt hier
    z.B., dass der Domainname richtigaufgel√∂st werden kann.Zus√§tzlich wird
    eine√úb erpr√ºfungderAbsender-DomaingegendieglobalimInternetverf√ºg-
    bareReal-timeBlackholeList(RBL)durchgef√ºhrt.FallsdieDomainaufdieser
    Listezundenist,wirddieE-Mailzur√ºckgewiesen.

(^2) https://www.clamav.net/


- √úb erpr√ºfungdesInhaltes:NachdemderersteSchrittdurchgef√ºhrtworden
    ist, wirdder Inhaltder E-Mail b etrachtet.Hierkommen Technologien wie
    Malware-Scannerf√ºrAnh√§nge,sowieSpam-Filterf√ºrdentextlichenInhaltder
    NachrichtzumEinsatz.Sowird√ºb erpr√ºft,obsichimAnhango derimText
    unerw√ºnschteInhalteb enden.DieDenitionvonunerw√ºnscht,mussimFalle
    desSpam-FiltersderAdministratoro derdasUnternehmenselbstdenieren.
    DieseEinstellunggeltenglobalf√ºralleE-Mails,dieamSystemeintreen.
- √úb erpr√ºfung am Rechner desEndanwenders: InletzterInstanz wird
    auf dem Zielrechner des Benutzers dieE-Mail √ºb erpr√ºft. Lokalinstallierte
    E-Mail-ProgrammewieMicrosoftOutlo oko derMozil laThunderbirdk√∂nnen
    no chmals miteigenenMalware- o der Spam-Erkennungssoftware dieE-Mail
    √ºb erpr√ºfen.DieseFilterinstanzstellteineb essereIndividualit√§talsdieob en
    genannteglobaleFilterrichtliniedar.

#### 3.2.2 Vorgang

Beidem Messsystemhandelt essich um einpro duktives System, dastagt√§glich
E-MailsimUnternehmensumfeldempf√§ngt.Diesesarb eitetalsMTAinersterIn-
stanz,waseineVerarb eitunggleicherma√øenvonSpamsowief√ºrdenGesch√§ftsablauf
wichtigenE-Mailsb edeutet.

```
Abbildung8:√úb ersichtderMTAStrukturdesMesssystems.Quelle:Autor
```
WieinAbbildung 8 zusehenist,durchl√§uftjedeeingehendeE-MailinjedemFall
zuerstdenMTA.DieserwendetdiekonguriertenFiltermetho denaufjedeE-Mail
an.NachderFilterungwerdendielegitimenNachrichtenandenMailDeliveryAgent
(MDA)√ºb ergeb en,derdieZustellungandieentsprechendeMailb oxdesBenutzers
√ºb ernimmt.SomitbildetdieseInfrastruktureineArtKette,diezumVorteilhat,
dassderMDAmitdensensiblenBenutzerdatennichtdirektimInternetverf√ºgbar
ist.


InnerhalbdesMTAistesm√∂glich,dieFilterineinerentsprechendeReiheanzuord-
nen.DieseAnordnungistf√ºrdieVerarb eitungsgeschwindigkeitundEzienzn√∂tig.
Abbildung 9 zeigtdieimMesssystemeingesetzteAnordnung.

```
1.ImerstenSchrittstehthierder Postx selbstalsFilter.Dieserbietet rudi-
ment√§re Filtermetho denundkannsoschon eineschnellegrob eVorlterung
vornehmen.
2.Derdaran anschlie√øendeFilter istder Amavisd-New. Dieserstellt einegra-
nul√§reFilterungdar, jedo chsetztdieserzumeistan Metainformationender
E-MailundnichtamInhaltan.ImFalledieserImplementierung,wird√ºb er
denAmavisd-Newno chderVirenscannerClamAV b edient.Dieser√ºb erpr√ºft
dannerstdenAnhangderNachrichtaufSchadsoftware.
3.Vor der √úb ergab ean denMDA, wirdder Textder E-Mailno ch vomSpa-
massassin √ºb erpr√ºft.DiesererstellteinenindividuellenSpam-Levelf√ºrjede
Nachricht undf√ºgt diesen dem E-Mail-Header an.EineAuswertung dieser
LevelgeschiehtamMDA.
```
```
Abbildung9:FilterstrukturinnerhalbdesMesssystems.Quelle:Autor
```
Zur√ºckweisung

ImFalle,dasseineE-MailvomMTAzur√ºckgewiesenwird,erh√§ltdersendendeMTA
eineFehlermeldungvomempfangenden.MitdieserFehlermeldungwirddemsenden-
denSystemsignalisiert,dassdieNachrichtnichterfolgreichvomEmpfangssystem
angenommenwordenist.Sieb einhaltetindenmeistenF√§lleneineFehlermeldung
undeineFehlernummer,densogenanntenReject-Co de.√ÑhnlicheVerfahrenwerden
imHTTPangewendet.

DieFehlernummernwurdeinnerhalbderRFC 3463 standardisiertundstellenunter-
schiedlicheFehlerverhalteno derStadiendar[47,S.2].DieTextderFehlermeldung
isthingegenfreiw√§hlbar.


Filterregeln

ImDetailwerdenE-MailsmitunterschiedlichenEigenschaftenzur√ºckgewiesen,also
dieAnnahmederNachricht verweigerto dermitdementsprechendenSpam-Level
versehen.InwelchenF√§llendiesgeschieht,istindenfolgendenAuistungendarge-
stellt.

Zur√ºckweisungderE-MaildurchdenPostxandensendendenMTA:

- DieEmpf√§ngerdomainistdemMTAnichtb ekannt.
- DieEmpf√§ngeradressewirdnichtvomMTAverwaltet.
- DieNachrichtengr√∂√øe√ºb ersteigt52MB.
- DerServernamedesSendersistnichtvalidenachRFC 952 [20,S.1].
- DerServernamedesSendersistkeinFQDN.
- DerSenderistkeinevalideDomain,alsonichtzueinerIP-Adresseau√∂sbar.
- DersendendeServeristalsSpam-Versenderb ekanntundstehtaufeinerRBL.
- DersendendeServerhateinedynamischeIP-Adresse.

In folgenden F√§llenwird dieE-Mail an den sendendenMTA vom Amavisd-new
zur√ºckgewiesen:

- WennsichinnerhalbderE-MaileinAnhangmitentsprechenderDateiendung^3
    b endet.
- Wenn andieE-MaileineDateiangeh√§ngtwurde,dievomVirenscannerals
    Malwareklassiziertwurde.

NachdemdieeingehendeE-Maildieseb eidenStationenpassierthat,wirdimMess-
systemno cheineAnalysedestextuellenInhaltesdurchgef√ºhrt.HierzuwirdmitHilfe
desSpamassassinderInhaltauffolgendeMerkmaleuntersucht:

- Enth√§ltb ekannteSpam-URIs,dieineinerimInternetverf√ºgbarenDatenbank^4

(^3) EndungenimDetail:.ade,.adp,.app,.asp,.bas,.bat,.cer,.chm,.cmd,.cnt,.com,.cpl,.crt,
.csh,.der,.exe,.fxp,.gadget,.grp,.hta,.inf,.ins,.isp,.jar,.jse,.js,.ksh,.lnk,lib,.mad,.ma,
.mam,.mar,.mat,.mav,.mcf,.mda,.mdb,.mde,.mdt,.mdw,.mdz,.msc,.msh,.msh1,.msh2,
.mshxml,.msh1xml,.msh2xml,.msi,.msp,.mst,.ops,.osd,.p cd,.pif,.pl,.plg,.prf,.prg,ps1,
.ps1xml,.ps2xml,.psc1,.psc2,.pst,.reg,.scf,.scr,.sct,.shb,.shs,.sys,.tmp,.url,.vb,.vb e,
.vbp,.vbs,.vsmacros,.vsw,.vxd,.ws,.wsc,.wsf,.wsh,.xbap,.xnk.
(^4) [http://uribl.com](http://uribl.com)


```
stehen.
```
- Enth√§ltnicht-europ√§ischeSchriftzeichen.
- Statistische Pr√ºfung desTextes gegeneinest√§ndig aktualisierteDatenbank
    mitSchl√ºsselw√∂rternf√ºrSpam(VorgehensieheKapitel3.2.3).
- Pr√ºfenderMetainformationenundE-Mail-Header,wieAbsendero derEmp-
    f√§nger,aufUnregelm√§√øigkeiten.

NachdemauchdieseInstanzderFilterungpassiertwurde,wirdderE-MailderSpam-
Leveldeniert.Dieserb estimmtobessichb eiderNachrichtumHamo derSpam
handelt.EineZur√ºckweisungderE-MailwirdindiesemSchrittnichtmehrunter-
nommen.DerSpam-Levelb eschreibt,wieho chdieWahrscheinlichkeitist,dasses
sichumSpamhandelt.DieSkalareichtvon<5=keinSpam,‚â• 5 =m√∂glicherweise
Spam,bishinzu‚â• 15 =Spam.Durchjedenderob engenanntenTests wirdder
Spam-Level der E-Mailentsprechend erh√∂ht.Desto mehrTests p ositivausfallen,
umsoh√∂hersteigtderSpam-Level.

InjedemFallwirddieNachrichtdemEmpf√§ngerzugestellt.DerSpam-Levelwird
vom Spamassassin innerhalb der E-Mail-Headerals X-Spam-Score b enanntund
kannsomitvondern√§chstenInstanz,demMDA,ausgewertetwerden.BeimStan-
dardverhaltenwerden E-Mailsab einemSpam-Levelvon ‚â• 5 b eimBenutzerpro-
grammineinenSpam-o derauchJunk-Orderverschob en.

#### 3.2.3 Filtertechnologien.

UmdieeingesetztenFiltermetho denb esserzub eschreib en,werdendieseimfolgen-
denAbschnittno chmalsimDetaildargestellt.Hierb eiwerdendieFunktionenund
Detailmessungenb eschrieb en.

Anti-Malware-Filter

DerOp enSourceAnti-Malware-FilterClamAV bietetdurchseinekostenloseNut-
zungunddereinfachenM√∂glichkeitderIntegrationinunterschiedlicheMTAseine
solideAnti-MalwareBasis.DurchseinevonBenutzernundEntwicklernst√§ndigak-
tualisierteMalware-DatenbankunddemheuristischenAnsatzf√ºrunterschiedliche


Dateityp en,arb eitetermiteherklassischenTechnologien.DurchdieeinfacheInte-
grationundRobustheitistdieserMalware-ScannerimZusammenhangmitMTAs
weitverbreitet.

AusdemklassischenAnsatzdesClamAV bildetsichjedo cheinNachteilinBezug
aufdiesichst√§ndig√§nderndeMalware-Bedrohung.IneinigenF√§llenf√ºhrtdiesda-
zu,dasseineErkennungvonMalwareersteinige Tageversp√§teto dersogarganz
ausbleibt[44].EineschnelleAnpassungund√ÑnderungderSchadsoftwaretr√§gtzu-
s√§tzlichzueineschlechtenErkennungb ei[50,S.20].

UmaufeineaktuelleBedrohung(sieheKapitel2.4)Bezugzunehmen,wurdenin-
nerhalb desHoneyp ot-SystemsalleMicrosoftOce Dokumentemitenthaltenem
VAB-Makro-Co deextrahiertunddieseAnh√§ngeaufdemSystemabgesp eichert.Ei-
neeingehendePr√ºfung derAnh√§ngemitdemfreiverf√ºgbarenoletool^5 konnteein
heuristischesVerhaltensmusterundInhaltevonMalwaref√ºrjedeabgelegte Datei
b est√§tigen.Hieraus resultiertet, dassjede dieser Dokumente p otentielle Malware
darstellt.

ImTestgegendenClamAVwurden 191 dieserunterschiedlichenMalware-Dokumente
int√§glichenDurchl√§ufengepr√ºft.DerMalware-ScannerwurdeinderStandardein-
stellungb elassen undaktualisiertsomit jedenTag um 24 UhrseineDenitions-
datenbankf√ºrMalware.DasErgebniseinerviert√§gigenBeobachtungwar,dass 51
(26,70%)Makro-Malware-DokumenteausAnh√§ngenamTag desAuftreten nicht
erkanntwurden.Sieb ensindnachmehralseinemTagnichtalsMalwareklassiziert
worden.SelbstdieimClamAV integrierteheuristischeErkennungvonsch√§dlichem
VBA-Makro-Co deinMicrosoftOce Dokumentenschlughierb einichtan.Somit
liegtdie Wahrscheinlichkeit,dasseine NachrichtmitMakro-MalwarealsAnhang
nicht amselb enTag desAuftretenserkannt wirdb ei30,37% ( 19158 = 0, 3037 ). 24
Stundensp√§terverringertsichdieseauf3,7%( 1917 = 0, 037 ).

Abbildung 10 zeigtsehranschaulich,inwelchenWellendieSpam-Kampagnenmit
angeh√§ngterMalwareauftretenk√∂nnen.InnerhalbdieserSpam-Wellensindbiszu
44 eingehendeNachrichtenproMinutezub eobachten.BeieinerWahrscheinlichkeit
von30,37%auf 44 Nachrichtenangewendet,ergibtaufeineganzeZahlgerundet 13
(13,36)vomClamAV nichterkannteAnh√§ngederNachrichtenproMinute.Hierb ei
wirdvomFallausgegangen,dassanjedereingehendenE-MaileinandererMalware-

(^5) https://bitbucket.org/decalage/oleto ols/wiki/olevba


Abbildung10:Spam-Kampagnen mit Malware als Anhang - Zeitraum 23.04-
23.05.2016.Quelle:Autor

Anhangangeh√§ngtist.InvielenvomAutorb eobachtetenF√§llenwerdenjedo chb ei
Kampagnenimmerderselb eTypvonMalwareversendet,wasdieWahrscheinlichkeit
einerInfektionb eieinerNichterkennungdiesereinzelnenDateisteigenl√§sst.

AusdiesenZahlenistzuerkennen,dasseinAnti-Malware-Scannerdazuneigt,Mal-
wareb ehafteteDokumentenichtalsMalwarezuerkennen.DurchdiehoheAnzahl
derMalware-Nachrichten,dieamE-MailsysteminWelleneingehen,erh√∂htsichso
dieWahrscheinlichkeiteinerZustellungunddamitauchdieeinerInfektion.

InderPraxistendiertdurchz.B.einenAbsender-FilterdieAnzahldertats√§chlich
zugestelltenNachrichtennachunten,dieErkennungsratedesVirenscannersselbst
b eliebtjedo chunangetastet.ImKapitel4.2.2wirdhierno chgenauerBezuggenom-
men.

Anti-Spam-Filter

EineBasisf√ºrdieerstenAnti-Spam-FilteristinderRFC 2505 ausdemJahre 1990 zu
nden.DamalswurdenersteMa√ønahmenzurVerhinderungvonSpamb eschrieb en,
diesichgrunds√§tzlichandenMetainformationenorientierten[28,S.6].Ausdiesem
Dokument wurdeneine weitereVorgehensweise entwickelt, um einintelligenteres
undmehraufdenText fokussiertesAnalysierenzuetabliert.Einer derVorreiter
aufdiesemGebietwarPaulGraham.ErentwickelteaufBasisdesmathematischen
GesetzesdesbayesschenFilterseinsto chastischesMittelgegenSpam[19].

UmSpamvonHamgrundlegendzuunterscheiden,wirddieWahrscheinlichkeitmit
1 √ºb er 2 b ezeichnet.Dasb edeutet,dassdieWahrscheinlichkeit(P),dasseineE-Mail
Spam(S)o derHam(H)ist,gleichverteiltist.


##### P(H) =P(S) =^12

DieseDenitionistsehrstatischimHinblickaufdievariierendeVerteilungzwischen
demSpam-undHam-AnteilinnerhalbdesE-Mailverkehrs.Jedo chistdieseeinsehr
guterAnn√§herunganeinenpraxisnahenWert.

Eine zweiteAnnahme gehtdavon aus, dassdie b etrachteten Wortesto chastisch
unabh√§ngigauftreten.DiesistaufdenerstenBlickeineeherparadoxeAnnahmen,
dagewisseWorteh√§uginZusammenh√§ngenauftreten[39].AusdieserVerarb eitung
desTexteswirdeineWortliste/Vektorerzeugt[4,S.2].

DerSpamassassinarb eitetunteranderemmitdieserTechnik,umeineE-Mailent-
sprechendalsHamo derSpamzuklassizieren.AnhandderWortlisteunddenE-
Mail-HeadernkanndurchAbgleichvon√ºb er 100 Testabl√§ufeninnerhalbdesSpa-
massassineinSpam-Levelermitteltwerden[42].

EingezieltesAusheb eln derTests kannunteranderem,durcheiner√úb erh√§ufung
desE-Mail-TextesmitlegitimenTextbausteinenerreichtwerden.Einezielf√ºhrende
BewertungderTestskannsomitnichtmehrstattndenundderFilterentscheidet
zugunsten der False-Positive-Rate,dassessich umein HamE-Mail handelt[40,
S.6].ImeinfachstenFallwerdenBuchstab endurchSonderzeichenersetzto dergar
BilderalsTexteingef√ºgt[3,S.7].

Zus√§tzlichzurdynamischenAnalysemitdenTestabl√§ufenkommenstatischeListen
mitSpam-URIszumEinsatz.Eshandeltsichdab eiumimInternetzug√§nglicheLis-
tenmitURIsundDomainnamen,dievonSpam-Versenderh√§ugverwendetwerden.
IsthiereineVerlinkungzueinerDomaino derURIausdieserListeinnerhalbdes
E-Mailtexteszunden,b estehteinesehrhoheWahrscheinlichkeit,dassessichum
Spamhandelt.

Spam-Kampagnen,diehinsichtlichderWirkunggegeneinenAnti-Spam-Filteropti-
miertwurde,b estehtkeineM√∂glichkeitmitdeneingesetztenTechnikenmehr,diese
aufBasisderTextezuerkennen.


### 3.3 Messungen.

F√ºrdieMessungwurdederMesspunktdeseingehendenMTAsb estimmt.Hierkonn-
tedurchdieAnalyse derLog-DateieneingenauesBildderVerarb eitungder ein-
gehenden Nachrichten erstellt werden. Alle Filterinstanzen dokumentiertenjedes
FiltereventineineentsprechendeLog-Datei.DieEintr√§geindiesenLog-Dateienb e-
schreib enb eieinemMalware-o der Spam-BefunddenGrundf√ºrdieAuslterung
derNachricht.

UmeineLangzeitanalysezuerm√∂glichen,werdendieLog-Dateient√§glicharchiviert
undk√∂nnensof√ºrsp√§tereAuswertungenherangezogenwerden.DieAuswertungen
selbstwurdenmitdenTo olspogsumm^6 undlogwatch^7 durchgef√ºhrt.F√ºrdiegra-
phischeAufarb eitungkamdasProgrammMailgraph^8 zumEinsatz.

DieMessungenselbsterstrecktensich√ºb erdenMonatAprilimJahr2016.Innerhalb
diesesMonatswarkeinFeiertagsowiekeinesonstigenau√øergew√∂hnlichenEreignis-
se, dieden E-Mailverkehrb eeinusst h√§tten, vorhanden.Startzeitpunkt warder
01.04.2016 um06:24UhrundderEndzeitpunktder 30.04.201600:00Uhr.Somit
wurdeeinMonatmit 25 Arb eitstagenund 5 Wo chenendtagenabgebildet.

#### 3.3.1 Ergebnisse

ImFolgendenwerdenalleermitteltenMessdateninaufb ereiteterFormdargestellt.
Aufb ereitethei√øthierb ei,dassnichtganzzahligeDatenaufzweiNachkommastellen
gerundetundp ersonenb ezogeneDatenentferntwurden.AlleDatenbasierenaufden
entsprechendenLog-DateienundsindnichtauseinerEchtzeitanalyseentstandenen.
BeidemSystemhandeltessich,wieerw√§hnt,umeinepro duktivesundf√ºrdieallt√§g-
licheArb eitskommunikationverwendeteSystem.AlleWertestellendeneingehenden
Nachrichtenussdar.

(^6) https://jimsun.linxnet.com/
(^7) https://sourceforge.net/pro jects/logwatch/les/
(^8) [http://mailgraph.schweikert.ch/](http://mailgraph.schweikert.ch/)


Filterungsschritt1:Postx undAmavisd-new

Umeinen√úb erblick√ºb erdasSystemzub ekommen,sindinderTab elle 2 dieMess-
datenderFilterinstanzenPostx sowieAmavisd-new ineiner√úb ersicht√ºb erden
gesamtenMesszeitraumhinweg.

```
AnSpamassassin 74.059 68,91%
```
```
Zur√ºckgewiesen 33.414 31,09%
```
```
Gesamt 107.470 100%
```
```
Tab elle2:EmpfangeneNachrichtenimMesszeitraum.
```
AusderTab elle 2 istzuentnehmen,dass31,09%derempfangenenNachrichtenschon
indenerstenb eidenFilterinstanzendirektzur√ºckgewiesenwerden.Nur68,91%der
E-MailswurdenandenSpamassassinf√ºreinetextbasierteSpam-Analyseweiterge-
leitet.

Beiallenzur√ºckgewiesenenE-Mailshandeltessichum E-Mails,dienichtanden
Empf√§ngerzugestelltwurdenundzur√ºckgewiesenworden.DersendendeServerer-
h√§ltvom MTAeineentsprechendeNachricht,dassdieAnnahme verweigertwur-
de.

InderTab elle 3 isteinegenauereAufstellungderGr√ºndef√ºrdieZur√ºckweisungzu
sehen.AufgeteiltsinddieseindiefolgendenRubriken:

- Verbindungsfehler: BeidiesemTyphandelt es sich um Nachrichten,die
    schon b eimVerbindungsversuch zur√ºckgewiesen wurden. Zumeistsind hier
    falscheo derfehlendeServernamendesSenderso derVerbindungsabbr√ºche,als
    auchPort-ScansderGrund.
- Adress√ºb erpr√ºfung: Hierb eiwurdedieE-Mailadresse desEmpf√§ngersim
    Zielsystemnichtgefunden.SomitisteineZustellunganeinnichtvorhandenes
    Postfachnichtzielf√ºhrendunddaherwirddieE-Mailzur√ºckgewiesen.
- RBL: FallseineE-Mail aufeinerderimInternet verf√ºgbarenRBLssteht,
    kanndavonausgegangenwerden,dassessichhierb eiumSpamhandelt.Die
    E-Mailwirddaherzur√ºckgewiesen.


Abbildung11:AnzahlderE-MailsamMesssystemmitentsprechendenDateiendun-
gen.Quelle:Autor

- Blo ckierte Dateiendungen: Der Amavisd-new Filter dientzu Filterung
    der Anh√§nge undverweigert die Annahme b ei verb otenen Dateiendungen.
    InAbbildung 11 ist dieAufteilungderunterschiedlichenDateiendungenzu
    sehen.DieDateineungen.jsf√ºrJavascript-Dateiensowie.exef√ºrausf√ºhr-
    bareProgrammewurdenhierb eigeschlossenzur√ºckgewiesen.Beidesindmit
    hoherWahrscheinlichkeitMalware[14].Die.crtEndungstehtf√ºreineZerti-
    katsdatei,dieimNormalfallnichtviaE-Mailversendetwirdundsomitauch
    zur√ºckgewiesenwurde.
- Malware: Beidieser RubrikhandeltessichumZur√ºckweisungen,dievom
    Amavisd-newdurchgef√ºhrtwerden,wenneinVirusvomClamAVerkanntwur-
    de.


```
Verbindungs-
fehler
```
```
Adress-
√ºb erpr√ºfung
```
```
RBL Blo ckierte
Dateien-
dungen
```
```
Malware Summe
```
##### 3.162 3.154 26.259 836 3 33.414

##### 9,46% 9,44% 78,59% 2,50% 0,01% 100%

```
Tab elle3:Aufteilungderzur√ºckgewiesenenNachrichten
```
Filterungsschritt2:Spamassassin

Die nachdem Filterungsschritt 1 verbleib enden74.059E-Mailswerdennunno ch
vomSpamassassin√ºb erpr√ºft.DieserhatnundieAufgab e,dieNachrichteninnerhalb
ihrer Metainformationundtextuellen Inhaltenaufb ekannteSpam-Eigenschaften
zuuntersuchen.NachdieserKlassizierungwurden4.713(9%)durchdiesenFilter
alsSpammarkiert,dasieentsprechendeMerkmaleeinerSpam-E-Mailhatten.Die
restlichen69.346(81%)von74.059wurdennunandieentsprechendenEmpf√§nger
ohneeineSpam-Markierungzugestellt(Abbildung12).

```
Abbildung12:FilterungdesSpamassassin.Quelle:Autor
```
NimmtmanalleFilterungsschrittezusammen,sinddas69.346E-MailsimMonat
April 2016 auf 753 Empf√§nger.Dasb edeutetaufdieEmpf√§ngeraufgeteiltrund 92
E-MailsimMonat.


#### 3.3.2 ZusammenfassungderMessungen

InderSummeallerFilterinstanzensindessomit38.127Nachrichten,dieentweder
alsSpamdeklarierto derdirektschonzur√ºckgewiesenwurden.Prozentualb est√§tigt
istderAnteilderdamitungewolltenE-Mailsb ei107.473Nachrichten35,48%.Laut
derStatistikvonSymantecliegtderweltweiteMittelwertb eieinerFirmamit501-
1000 Mitarb eiternb eirund53,5%(Abbildung13).

```
Abbildung13:Spam-Rep ortvonSymantec.Quelle:Symantec[41]
```
Somitliegt dasMesssystemmit18,02% hinterdenvon Symantec herausgegeb en
Zahlen,waszuvernachl√§ssigenist,dadiesenichtexpliziteinUnternehmenwider-
spiegeln,sondernglobaleZahlenf√ºrdieErmittlungheranziehen unddarauseine
gro√øeVarianzentsteht.DerUmfang,wieofteineE-Mailinnerhalbderzugestellten
64,52%f√§lschlicherweisenichtalsSpammarkiertwordenist(False-Positive),bleibt
hieroen.

### 3.4 DarstellungdesDezits.

Dieob engenanntenFiltermetho denundVorg√§ngezurVerhinderungvonSpamund
MalwarezeigtimVergleichzudenglobalenStatistikenvonSymantec,dassrund
50%derempfangenenE-MailsSpamenthalten.Denno chkommtesimmerwieder
dazu,dassE-MailsvondenFilterinstanzennichterkanntwurden.

DieaktuellenFiltermetho denbietenvieleM√∂glichkeiten,E-Mailsaufentsprechende
Merkmalehinzuuntersuchen,jedo chobliegtesimmerdemBetreib er,wierestriktiv
erdieseeinsetzt.EinezustarkeEinschr√§nkungderEmpfangslterf√ºhrtunweigerlich
zueinerErh√∂hungderFalse-Positiv-RateinBezugaufHam-E-Mails.Dashei√øt,dass


legitimeE-MailsalsSpamvomSystemerkanntwerden,wasausBenutzersichtsehr
negativist.DiegezogeneStatistikausdemMesssystemzeigt,dassderMittelwert
desSpam-Level,dasderSpamassassineinerHamE-Mailzuweist,b eieinemWert
von2,5liegt.WennderLevel‚â• 5 ist,wirddieE-MailalsSpammarkiertundlandet
somitimSpam-Ordnerdes Benutzers.3.107E-Mailshab enimMesszeitraumein
Levelvon 4 erreicht.W√ºrdemanhieralsoeinrestriktiveresRegelsetanwendenund
dasLevelf√ºreineSpam-Nachrichtauf‚â• 4 herabsetzen,w√ºrdendieseE-Mailsals
SpammarkiertandenBenutzerzugestelltwerden.

BeiderBetrachtungdesAmavisd-newunddesPostxsinddieFolgeneinerFalse-
Positiv-ErkennungmiteinerZur√ºckweisungverbundenundsomitwirddieE-Mail
erstgarnichtangenommen.DerSendererh√§lthierb eieineFehlermeldung,dassdie
E-MailnichtZugestelltwurde.DasimFalledesMesssystemsangewendeteBlo ckie-
renb estimmterAnh√§nge(sieheKapitel3.1)hataucheinenEinussaufdieKom-
munikation z.B.mitKunden.Durchein grunds√§tzlicheBlo ckieren vonMicrosoft
Oce Dokumentenmiteinem aktivenVBA-Makro-Co de, kann infolgedessendie
E-MailkommunikationmitGesch√§ftspartnernempndlichgest√∂rtwerden.Beieiner
ErhebungineinemKundensystemwurdeermittelt,dassvon464.150Nachrichten
mitMicrosoftOceDokumenten9.863einlegitimesMakroenthalten.ImFalleei-
nesrestriktiverenAnsatzesunddemBlo ckierensolcherDokumentew√ºrdendiesean
denSenderzur√ºckgewiesenwerden,wasdendamitverbundenenGesch√§ftsprozess
unterbindenw√ºrde.

DieseMetho de,MicrosoftOceDokumentenmiteinemaktivenVBA-Makro-Co de
zublo ckieren,wirdjedo chh√§ugalsGegenma√ønahmef√ºrMakro-Malwareangege-
b en[9,S.11]und[48,S.5].AnhandderermitteltenZahlen scheintdiesejedo ch
nicht zielf√ºhrendf√ºrdieAbbildungeinesGesch√§ftsprozesses,deraufDokumente
mitVBA-Makrosbasiert.

EinFreischaltenderentsprechendenKommunikationspartnervondiesemFilterw√ºr-
deaufgrundderM√∂glichkeit,inE-MailsdenAbsenderzuf√§lschen,eherkontrapro-
duktivsein.Schlimmeristhierno ch,dassBenutzerhierdurcheinenichtvorhandene
Sicherheitvorget√§uschtwirdunddieWahrscheinlichkeitf√ºrdas√ñnendesAnhan-
geszunimmt.Fallsjedo chdieseBlo ckierregelnichtaktiviertwird,l√§sstmanauch
unweigerlichdieinKapitel2.3b eschrieb eneMalware-Typ enzu.Soergibtsichein
DilemmazwischendemZulassenvonp otentiellgef√§hrlichenAnh√§ngenundderne-
gativenBeeinussungdest√§glichenGesch√§ftsablaufes.


Zusammengefasstwirdersichtlich,dassdieetabliertenFiltermetho denhiereinsehr
starres,ab erezientesKonzeptbieten[1,S.4].SiebildeneinensolidenGrund-
schutz k√∂nnen jedo chnicht exib el unddynamischauf neue o der sich √§ndernde
Bedrohungenreagieren.


## 4 NeueAns√§tze

### 4.1 R√ºckschl√ºsseausdenMessergebnissen

DieerbrachtenErgebnisselassendaraufschlie√øen,dassdieklassischenFiltermetho-
deneineBasisbietenundauchb ereitsschoneinGro√øteilderBedrohungeneliminie-
renk√∂nnen.Jedo chwandeltsichdieBedrohung,wieinKapitel2.4.1b eschrieb en,
st√§ndig.Zudemetabliertsichw√§hrendderFilterungzwangsl√§ugaucheineArtQua-
lit√§tspr√ºfung.Diesb edeutetb eieinerNichterkennungeinermitSpamo derMalware
b ehaftetenE-Mail,dassdieseeineerh√∂hteQualit√§taufweisenmuss.Dasmussnicht
zwangsl√§ug zueinererh√∂htenWahrscheinlichkeitf√ºhren,dasseine Infektioner-
folgt,jedo chwirdeshierb eif√ºrdenBenutzerauchschwererdieseNachrichtenals
Spamzuklassizieren.BeieinerzugestelltenE-MailmitMalwareimAnhangb e-
stehtdieletzteFilterinstanzdarin,dassderBenutzerdiesealssolcheerkenntund
denAnhangnichtausf√ºhrt.AutomatisierteMetho denhab eninsoeinemFallkeine
Anwendunggefunden.

### 4.2 NeueWegederErkennung

Aufbauendaufdem FundamentderexistierendenFiltermetho denwurdensich in
dieserArb eitmitneuenAns√§tzenauseinandergesetzt.ImFokusstehthierdieImple-
mentierungeinfacherMetho den,diezumexistierendenSystemhinzugef√ºgtwerden
k√∂nnten.EntstandensinddieseMetho dendurchdieBeobachtungundAnalyseder
ermitteltenMesswerte.Zus√§tzlichwurdenProblematikenundErkenntnisseausdem


```
Abbildung14:F√ºrdenBenutzeroensichtlicheSpam-Nachricht.Quelle:Autor
```
Betriebsalttagmiteinb ezogen.EinBeispielhierf√ºristdieAusarb eitungdesKonzep-
teszurVerhinderungvonMalwareinMicrosoftOceDokumenten.Dieseswurde
auseinerProblematik(siehe3.4)ausdemBetriebsablaufherausentworfenundstellt
somiteinesehrnaheBindungzueinemrealenProblemdar.

#### 4.2.1 VerhinderungvonSpamdurchb ekannteAbsender.

AusderAnalysedesSpam-VerhaltensanhanddesMesssystemkonnteermitteltwer-
den,dass35,48%derNachrichtenalsSpamvonkonventionellenFiltereinrichtungen
erkanntwurden.Jedo chb estehtimmerwiederdasProblem,dassSpam-Nachrichten
alsFalse-NegativandenBenutzerzugestelltwerden.

InAbbildung 14 konntedieNachrichtnichtvondenautomatisiertenFilterinstanzen
aufdemMesssystemerfasstwerden.DerTest,obvomAbsenderdieAbsenderadresse
vergessenwordenist,b ewertetderSpamassassindieE-Mailhierb eip ositivmit2,095
und1,552 (FREEMAIL_FORGED_REPLYTO undREPLYTO_WITHOUT_TO_CC)als Spam.
Zus√§tzlichkommenno cheinefehlerhafteAu√∂sungderAbsender-Domainmit0.792
(RDNS_NONE).Daraus ergibtsicheinSpam-Levelvon 4,438.DerBayes_00-Test^1
verringerthierb eijedo chdengesamtenSpam-Levelum-1,9Punkte,daerausdem
TextkeineSpam-Eigenschaftenermitteltworden.DieseVorgehenwirdzuGunsten
derFalse-Positiv-Ratedurchgef√ºhrt.Esergibtsichaus4,438-1,9einSpam-Levelvon
2,538was<5istundsomitdieNachrichtnichtalsSpamklassiziertwird,obwohl
siediesnachweislichseinsollte.

(^1) https://wiki.apache.org/spamassassin/Rules/BAYES_00


```
Listing4.1:PositiveTestsdesSpmassassinmitBewertung
X - S p a m - T e s t s : B A Y E S _ 0 0 = - 1. 9 , F R E E M A I L _ F O R G E D _ R E P L Y T O = 2. 0 9 5 ,
R D N S _ N O N E = 0. 7 9 3 , R E P L Y T O _ W I T H O U T _ T O _ C C = 1. 5 5 2
```
F√ºrdenBenutzeristhierimBeispiel(Abbildung14)klarerkennbar,dassessichum
Spamhandelnmuss.InvielenF√§llenwirddiesausdemKontextersichtlich.Dieser
entstehtausdemAbsendersowieInhaltderE-Mail.DerBenutzerschlie√øtausdiesen
b eidenInformationen,obessichumeineHam-o derSpam-E-Mailhandelt.

DieseeinfacheAuswertungob,diederBenutzermeistunterb ewusstf√ºrjedeE-Mail
durchf√ºhrt,l√§sstsichineinMTA-Filter-System√ºb erf√ºhren.Hierzusindkeineho ch
komplexenAlgorithmenn√∂tig,sonderneinedynamischwachsendeDatenbankmit
allenEmpf√§ngeradressenausgehenderE-Mails.ImDetailm√ºsstedieseDatenbank
vomausgehendenE-Mailsystemb ef√ºlltwerden.SobaldeineE-Mailaneinenexter-
nenEmpf√§ngergeht,wirddieseE-Mailadressealsb ekanntinderDatenbankhin-
terlegt.HierauserzeugtsicheinedynamischwachsendeWhitelist,diealleKommu-
nikationspartnerauistet.DieseDatenbankwirddemSpamassassinzurVerf√ºgung
gestellt,derdannsomiteinweiteresBewertungskriteriumb ekommt.

SokanndurchdieAnalysedesTextesundderE-Mail-HeaderderSpam-Filterschon
eineguteEinsch√§tzungliefern.Solltejedo chdieEntscheidungzweifelhaftausfallen,
wieob enb eschrieb en(Spam-Levelzwischen 0 und5),k√∂nntedieseDatenbankeine
weitereEinscheidungsgrundlagebieten.IneinemerstenTestmit 35 False-Negativ
Spam-Nachrichtenwurdeermittelt,dassalledurchdieseMetho deerkanntwerden
k√∂nnten.DerSpam-Levellagb eijedergetestetenE-Mailzwischen 0 und4,9.

InnerhalbdesSpamassassinwerden√§hnlicheFunktionenschonverwendet.DieAuto-
Whitelist-FunktionmerktsichimmerdenletztenSpam-LeveleinesAbsenders.Ein
Beispielw√§rehier,wennBobeineSpam-E-MailmitLevel 10 sendet,wirddiessoin
derDatenbankvermerkt.SchicktBobeineweitereE-Mail,dieab ernureinLevelvon
2 hat,wirddieservomaltenWertabgezogen.Also10-2=8,wob ei 8 dasneueLevel
ist[46].BeiderBeobachtungamMesssystemzeigtsichdenno ch,dassimMesszeit-
raum21.439Absendereingehendvermerktwurden.Hiervonhab enjedo chnur4.744
mehralseineE-Mailgesendethab en.16.695Absender(77,87%)hab enausschlie√ø-
licheineE-Mail√ºb ermittelt.Darausergibtsich,dassb ei4.744(33,23%)lediglich
einMehrwertdurchdasWhitelistingentsteht.AlleanderenEintr√§gew√ºrdeninder
Datenbankverweisen, dakeine weitereE-Mailmitdemselb en Absenderempfan-


genwird.H√§ughandeltessichumSystem-o derSpam-E-Mails,dieautomatisiert
generierteAbsenderaufweise.

Derb eschrieb eneueAnsatzinvertiertdiesesVorgehenundk√∂nntehierb eieineb es-
sereErkennungeinerschonvorhandenKommunikationliefern.DieWahrscheinlich-
keit,dasseineKommunikationaufgrundeinerSpam-E-MailmitdemSpamversender
stattndet,istvernachl√§ssigbar.Zudemw√ºrdedieseErweiterungderErkennungerst
eingesetztwerden,wennderSpam-LevelineinemSchwellenb ereichzwischen 0 und
4,9desSpam-Levelsliegenw√ºrde.Ob erhabundunterhalbdiesesBereichesw√ºrde
dieseDatenbanknicht f√ºreineweitereBewertungder E-Mailherangezogen wer-
den.

ImBeispielw√ºrdeBobanAliceeineNachrichtsenden.DieseNachrichterh√§ltam
Spam-Filtereingehendden Spam-Level-1undwirdanAlicealslegitimeE-Mail
zugestellt.AliceantwortetaufdieseNachrichtundsomitwird√ºb erdenAusgangs-
serverdieEmpf√§ngeradresse indieDatenbankeingetragen.SendetBobnuneine
weitereNachrichtmitdemSpam-Levelvon4,8anAlice,w√ºrdederEintraginder
Datenbankdie Nachricht alsHam erkennen,da schon eine ausgehendeKommu-
nikationmitBobundseinerE-Mailadresse stattfand.Fallsjedo cheineNachricht
einesSpam-VersendersmiteinemniedrigenSpam-Levelvon3,2vomSpamassassin
erkanntwird,kanndieseNachricht,aufgrunddesfehlendenEintragesderAbsender-
adressedesSpam-VersenderinnerhalbderDatenbank,b esserb ewertetwerden.Eine
Erh√∂rungdesSpam-Levelsum 3 Punktedurchdiezus√§tzlicheBewertung,w√ºrdein
solcheinemFalldieNachrichtalsSpammarkieren.

GenerellistdieserAnsatzaneinemGreylisting(RFC6647)angelehnt[24,S.3].
Hierb eiwerdenhierNachrichtentemp or√§rb eimerstenSendenvom empfangenen
MTA zur√ºckgewiesen. Der sendende MTA versucht nach einer Zeitspanne dann
no chmalsdieNachrichtandenempfangenenMTAzusenden.NachdemzweitenVer-
such,wirddieNachrichtvomempfangenenMTAdannendg√ºltigangenommenund
derAbsenderineinerDatenbankhinterlegt.SendetdieserAbsendernunno chmals
eineNachricht,wirddieseaufgrunddesDatenbankeintragsdirektangenommen.Die-
sesVorgehensollSpam-Versenderabhalten,dadieseeventuellnichtversuchendie
Nachrichteinzweitesmalzuzustellen.Problemist,dassdergesamtenNachrichten-
ussb eiunb ekanntenAbsendernstarkverz√∂gertwird.Zus√§tzlichist dieEzienz
sehrgeringeinzusch√§tzen[11,S.5]undSpam-undMalware-Versenderh√§ugdieses
Vorgehenvorhersehenunddurchno chmaligessendenausheb eln[31,S.6].


Beidemausgearb eitetenAnsatzwirdimDetailnichteineunb ekanntenDatenbasis
verwendet,sonderndieb ekanntenundlegitimenAbsenderderausgehendenNach-
richten.SoentstehteineschlechtereBewertungeinerNachrichterst,wennsiedem
Systemnichtb ekanntist.BeidiesemAnsatzwirdsoauchdieM√∂glichkeitgenom-
men,dasSystemdurchsendenvonentsprechendpr√§pariertenE-MailszuManipu-
lieren.EineErweiterungderDatenbankistnur√ºb erdasausgehendeSystemm√∂g-
lich.

Aus technischer Sicht, m√ºsste der Spamassassin lediglich eine Schnittstelle bie-
ten,wor√ºb ervertrauensw√ºrdigeSystemeAbsenderinderDatenbankb ekanntgeb en
k√∂nnten.

```
Abbildung15:Konzeptf√ºrdieEinbindungderAbsenderdatenbank.Quelle:Autor
```
Eswurdeermittelt,dassb eidenausgehendenE-MailsimMonatrund4.280Absen-
derverwendetwerden.Dashei√øt,dass4.280verschiedene Adresseninnerhalbder
Datenbankvermerktwurden.DieseZahlh√§ltsichsehrkonstant.ZwischendemMo-
natAprilundMai 2016 wurdeninderE-Mailinfrastrukturlediglichnur 230 neue
Adressenregistriert.ImJahrsinddasho chgerechnetrund2.760b eiderAnnahme
einerkonstantenWachstumsratevon 230 imMonat.Imb estenFallhab enalleEin-
tr√§geeinVerfallsdatum, dassdenEintraginvalidiert,fallserseitmehralseinem
Jahrnichtmehrb eobachtetwerdenkonnte.BeidiesenEintr√§geninderDatenbank,
kannvoneinereinmaligenKommunikationgespro chenwerden.

#### 4.2.2 VerhinderungvonMakro-Malware.

Die inKapitel2.3b eschrieb eneWandlungvomAusnutzenvonSchwachstellen in
Programmeno der Protokollenzieht sich hinzur Schwachstelle Mensch.Umdie-
seSchwachstelle b esserautomatisiertzusch√ºtzenwurde einAnsatz mithilfevon


AnalysenderDateiinhalteentwickelt.

BeidiesemAnsatzwirdzus√§tzlichvomVirenscannerjederankommendeAnhang
einerE-MailaufeventuelleMalware-Eigenschaftengepr√ºft.ImDetailwirdderFokus
aufdieDokumentdateityp enderMicrosoftOceProgrammfamiliegelegt,diedurch
.doc/.docx,.xls/.xlsxund.rtfb eschrieb enwerden.Siestellenmit88%einen
Gro√øteilder legitimen Anh√§ngedar. Beiden restlichen12% handelt essich um
komprimierterArchiveim.zip-Format(sieheAbbildung11).

DurchdieM√∂glichkeit,VBA-Co deindiesenDokumentenzuimplementierenstel-
lensieeinp otentielleGefahrdar.DieerkanntenDezite(Kapitel3.4)deraktuelle
eingesetztenFiltermetho denk√∂nnendieseArtvonBedrohungnachweislich(Kapitel
3.2.3)nichteliminiert.

ImFokusdiesesAnsatzes,solldiedynamischeundnichtaufVirus-Patternbasie-
rendeAnalysedesVBA-Co desinnerhalbderDokumentestehen.Nursokanneine
zuverl√§ssigeErkennungb eischnellwechselndenMakro-Inhaltengeschehen.DieEr-
kennungselbstsollkeinedirekteVerhaltensanalyseo derInterpretierungdesCo des
sein.Vielmehrwirdhierb eidieArtdesQuellco desunddieverwendetenFunktions-
aufrufeb etrachtet.

AlleWerteb eruhenaufAnalysenvon 25 unterschiedlichen,f√ºrdenUnternehmensab-
laufwichtigenMicrosoftOceDokumentenmitMakros.Ihnengegen√ºb erstanden
526 mitMalwareb ehaftete.Ausdiesenwurdeermittelt,welcheArtenvonFunkti-
onsaufrufenmiteinerhohenWahrscheinlichkeitnichtinlegitimenMakrosenthalten
sind.DieseAuswertungwurdedurchdieAnalysenvonAlexanderGazet[18]und
vomMicrosoftMalwareProtectionCenter[29]weiteroptimiert.DieGegenanalyse
von gutartigenMakrosergab,dassdieseineinigenPunkten dierenzierbarsind.
Abbildung 16 zeigteinBeispieleinesinVBAgeschrieb enenMalware-Co des.Man
kannhiererkennen,dassmitverschiedenenMetho denversuchtwird,dieeigentliche
Funktionzuverschleiern.EinBeispielw√§rehierb eidieVerwendungvonHexadezi-
malzahlenundzuf√§lliggenerierteFunktionsnamenimCo de.

AusdenAnalysenderDateienkonnteeinAusgangsheuristikf√ºrMalware-Dokumente
deniertwerden.F√ºrdieAnalysederDateienwurdedasTo olsetpython-oletools^2
vonPhilipp eLagadecverwendet.DiesebieteteineguteM√∂glichkeit,Dokumenteauf
dieseArtvonFunktionsaufrufezuuntersuchen.

(^2) [http://www.decalage.info/python/oleto](http://www.decalage.info/python/oleto) ols


```
Abbildung16:VBA-Co deeinerMalware.Quelle:Autor
```
FolgendeEigenschaftenundFunktionsaufrufek√∂nnenineinemDokumentmitMal-
wareVBA-Co degefundenwerden:

- SobalddasDokumentge√∂netwird,wirdeinFunktionsaufrufdurchgef√ºhrt.
- HerunterladeneinerDateivoneinerURL.
- EineDateiwirdgel√∂scht.
- EineDateiwirdangelegt.
- VersuchteineDateio derProgrammaufdemSystemauszuf√ºhren.
- VersuchteineKommandozeilezu√∂nen.
- VersuchteinSystemprogrammauszuf√ºhren.
- EineDateiwirdkopiert.
- DerCo deb einhalteteHexadezimalText.
- DerCo deb einhaltetBase64Text.
- VerschleierungenmitderFunktionChr()^3.

Die gelisteten Funktionsaufrufestellendie Ausgangsheuristikdar, sindjedo ch in
dieserFormnichtgewichtet.Zus√§tzlichm√ºssendieseFunktionsaufrufeundEigen-
schafteninderKombinationihresAuftretensb etrachtetwerden.DieKlassizierung
ausschlie√ølichaufeinerdieserFunktionsaufrufew√ºrdenichtzielf√ºhrendsein,dadiese
imEinzelfallauchinlegitimemCo deenthaltensind.

(^3) https://msdn.microsoft.com/de-de/library/613dxh46%28v=vs.90%29.aspx


```
Vorgang legitimenDokumente Malware-Dokumente
Auto-StartdesMakro 11 15
Dateil√∂schen,kopieren,erstellen 12 28
Programmaufruf 2 27
Dateiherunterladen 1 24
Kommandozeile√∂nen 1 28
Systemprogrammaufruf 0 28
HexadezimalText 0 497
Base64Text 0 494
FunktionChr() 0 492
```
Tab elle4:Anzahl der legitimen und Malware Dokumenten mit Auftreten der
Funktionen

InTab elle 4 isteineTendenzder 526 untersuchtenMalwareDateienzudenunter-
schiedlichenFunktionenzusehen.Rund 490 dieseDateienweisendieVerwendung
vonHexadezimalzahlen,Base64,sowiemitderChar()-Funktionco diertenTextauf.
Innerhalbdieser 25 legitimenDateienkonntekeinedieserFunktionengefundenwer-
den.Jedo chgilteshierzub eachten,dassdieseAuswertunggegen√ºb ereinergerin-
genAnzahllegitimerMakro-Co deteilestehtundsomiteinesp eziellenFallrepr√§-
sentiert.UmdieseAuswertungzuverallgemeinernwirdeinvereinzeltesAuftreten
dieserFunktionsaufrufe no chnichtzurKlassizierungdesDokumentsalsMalwa-
reverwendet.Funktionen,wiedas√ñnenderimMicrosoftWindows integrierten
Kommandozeile sowiedas Herunterladenvon Dateien,kann inEinzelf√§llen auch
imlegitimenCo deb eobachtetwerden.Betrachtetwerdenm√ºssendieseverd√§chti-
genFunktionsaufrufeineinerH√§ufung.ErstwennimCo demehrfachz.B.Base64
o derHexadezimalzahlenverwendetwerden,steigtdasPotentialMalwarezusein,da
hierdurchCo de-Teileverschleiertwerdenk√∂nnen.

GrundlegendergibtsichdieBewertungausdemGefahrenp otentialderFunktionen.
DasreineErstellenz.B.einerDateistelltkeinedirekteGefahrdarundwirdsomit
geringerb ewertet. EinemehrfacheVerwendungderChar()-Funktionjedo chl√§sst
dieVermutungsteigen,dasshierdurchFunktionenundCo de-Teileverschleiertwor-
densind.FunktionenwiedasAufrufenvonSystemprogrammehingegenwerdenb ei
einmaligemAuftretenschonalsstarkverd√§chtigangesehen.

UmdieseGefahreneinstufungdarzustellen,wurdeeineSkalavon 1 bis 10 deniert.
Hierb eiwirdmit 1 einegeringeGefahrsowiemit 10 einehohedargestellt.Hierauser-
gibtsichdieBewertungstab elle 5 mitderentsprechendenGefahrenb ewertung.Tritt


somiteineKombinationdieserFunktionenauf,werdendieWerteaddiert.Enth√§lt
alsoeinMicrosoftOceDokumenteinMakro,daseineDateiunddieKommando-
zeile√∂netsowiezus√§tzlicheinenDownloadstartenwill,erh√§ltesdieBewertung
2+8+5=15.

```
Vorgang Gewichtung(1-
10)
Beschreibung
Auto-StartdesMakro 2 AucheinlegitimerCo dekanndieseFunktionb einhal-
ten.
Dateil√∂schen,kopieren,erstellen 2 AucheinlegitimerCo dekanndieseFunktionb einhal-
ten.
Programmaufruf 5 KannineinlegitimenCo devorkommen,sollteesim
b estenFallab ernicht.
Dateiherunterladen 5 EinNachladenvonInhaltenstellteinRisikodar.
FunktionChr() 5 DieserAufrufkannein-biszweimalimlegitimenCo de
Vorkommen.
Kommandozeile√∂nen 8 DieserVorgang sollte selten in einemnormalen
Makro-Co devorhandensein.
Systemprogrammaufruf 10 DieserAufrufkommtseltenineinemlegitimenCo de
vor.
HexadezimalText 10 DieserAufrufkommtseltenineinemlegitimenCo de
vor.
Base64Text 10 DieserAufrufkommtseltenineinemlegitimenCo de
vor.
```
```
Tab elle5:AnsatzzurGewichtungderFunktionsaufrufeimMakro-Co de
```
NachdemdieE-MaileinenentsprechendeBewertungerhaltenhat,wirddiesegegen
einenglobaldeniertenWertgepr√ºft.DieserSchwellenwertb estimmt,ab welcher
Gefahrenb ewertungdesMarkos,dieE-Mailzur√ºckgewiesenwird.DieserSchwellen-
wertwurdeausderAnalyseder 526 Malwareund 25 legitimenDokumentenerstellt.
Hierb eiwurdezun√§chstderMaximalwertderlegitimenDokumenteermittelt.Dieser
lagb ei 12 Punkten.ImGegensatzzumMaximalwertwurdeno chderMinimalwert
derMalwareb ehaftetenDokumenteermittelt.Dieserlagb ei 14 Punkten.

AusderAnalysederMaximal-undMinimalwerteergibtsicheinSchwellenwertvon
13 Punkten.WirddieservoneinemDokumentmitMakro-Co de√ºb erschritten,wird
dieNachrichtandenAbsenderzur√ºckgewiesen.

NachderAnalysederDateienundderDenitionderHeuristik,alsauchdesSchwel-
lenwertes, wurde die Implementierungsm√∂glichkeit am MTA b etrachtet. Hierb ei
muss b eachtet werden, dassdiese indie aktuelle MTA-InfrastrukturundFilter-


metho den eingebundenwerdenmuss.F√ºrdieseAufgab eisteine Verwendungder
Milter-SchnittstelleimPostxalszielf√ºhrendanzusehen.DiesebietetdieM√∂glich-
keit,dieE-MailaneinenFilterweiterzugeb en,ohnedieNachrichtvollst√§ndigan-
nehmenzum√ºssen[53].

```
Abbildung17:PositiondesMacroMiltersimE-Mailuss.Quelle:Autor
```
WieinAbbildung 17 zusehenist,wirddieNachrichterstindieEmpfangs-Queue
f√ºrdieWeiterverarb eitunggegeb en,wenndieAnalysedesAnhangsabgeschlossen
ist.UmeinAnhangnichtdopp eltanalysierenzum√ºssen,istderEinsatzeinerDa-
tenbank mitb ekannten Malware-Anh√§ngen alszielf√ºhrend zub etrachten.Durch
die HinterlegungdesHash-Wertesdes Malware-Dokuments, kann b eieinem wie-
derholtenAuftretendiesesofortalsMalwareklassiziertundsodieDurchlaufzeit
verringern.

FolgendeSchrittesindf√ºrdieAnalysederAnh√§ngen√∂tig:

```
1.E-MailvomPostxviaMilter-Schnittelleweiterleiten.
2.AnnehmenderFilterextrahiertdenAnhang.
3.Pr√ºfenob,essichumeinMicrosoftOceDokumenthandelt.
4.Pr√ºfenob,einMakro-Co deenthaltenist.
5.DynamischePr√ºfungob,Makro-Co deaufdasMalware-Heuristikpasst.
6.E-Mailb eieinemp ositivenFundviaPostxanSenderzur√ºckweisenundHash-
WertinderDatenbankvermerken.
```
F√ºrdieErmittlungderEzienzundAnwendbarkeitdiesesAnsatzeswurdehiervom
AutoreinekonkreteImplementierungbasierendaufdiesemAnsatzdurchgef√ºhrt.Die
ImplementierungselbstwurdeunterdemNamenMacroMilter^4 erstellt.Grundlegend

(^4) [http://sbidy.github.io/MacroMilter](http://sbidy.github.io/MacroMilter)


spiegeltdieserallehierermitteltenBeschreibungendesAnsatzeswieder.

Messung

DerausdemAnsatzresultierendeMacroMilter wurdezus√§tzlichimMesszeitraum
(April2016)indasMesssystemimplementiert.SomitkanneineexakteAnalyseder
Ezienzdes Ansatzesgegen√ºb er denklassischen FilterinstanzendesPostifx und
Amavisd-New erstelltwerden.UmdasDezitgegen√ºb erdiesenb essersichtbarzu
machen,wurdederMacorMilter erstnachdemAmavisd-New eingebunden(siehe
Abbildung18).SomiterreichtendenMacroMilter nurNachrichten,dievondiesem
nichtgeltertwordensind.

```
Abbildung18:PositiondesMacroMiltersinderFilterkette.Quelle:Autor
```
DieAnalyseergab,dassimMesszeitraumaufdemMesssystem 91 E-Mailsmitei-
nem p otentiellenMalware-Co deinnerhalbeinesMicrosoftOce Dokumentsvom
PostifxundAmavisd-Newnichterkanntwurden.Hierb eikonntekeinerdervorgela-
gertenFilterdieseE-MailsalsMalwareo derSpamklassizieren.Zus√§tzlichweisen
83 (75,70%)dieserNachrichteneinenSpam-Levelvon<5aufundw√§rensomitim
PosteingangdesBenutzersgelandet.NurachtE-Mailshab eneinenSpam-Level‚â•5.
W√§hrenddesMesszeitraumeswurdenureineNachrichtalsFalse-NegativvomMa-
croMilter erkannt.DarausergibtsicheineFalse-Negativ-Ratevon1,12%,wasals
sehrgeringzub etrachtenist.

InderAbbildung 19 sinddieerfasstenDateiendungendargestellt.Hierb eiwurden
die Zur√ºckweisungendes Amavisd-New undMacroMilter zusammen dargestellt.
ImFalleder 11 .zipZur√ºckweisungen,wurdeeinMicrosoftOceDokumentmit
Malware-Co deinnerhalbdeskomprimiertenOrdnersgefunden.

AufdenGesamtanteilallerzur√ºckgewiesenenNachrichtengesehenistderAnteildes
MacroMiltersgeringe0,27%.Jedo chgehtvondiesen0,27%eineerh√∂hteGefahraus,
dadiesevomVirenscannerundSpam-Filternichterkanntwurden.


Abbildung19:Kombination desAmavisd-New undMacroMiltersf√ºrdie zur√ºck-
gewiesenenE-MailsmitdenentsprechendenDateiendungen.Quelle:
Autor

ImweiterenVerlaufkonntensoseitdem01.Februarbis01.Juni 2016373 Dateien
ampro duktivenE-MailserveralsMalwareklassiziertwerden.DasmachtimMonat
94 (93,25)erkannteNachrichtaus.

Zus√§tzlichkonnteb eidieserBeobachtungfestgestelltwerden,dassdieAngrieim-
merinWellenstattnden.DieAuswertungderMacroMilterStatistikamHoneyp ot-
Systemergab,dassdiemeistenAngrisversuchean Arb eitstagenvonMontagbis
Freitagzwischen11:00und14:00Uhrstattnden.DieseWertek√∂nntenalszus√§tz-
licheBewertungsgrundlagederAnh√§ngeeinie√øen.

TrotzderVorhaltungdereindeutigenHash-Wertejederschon√ºb erpr√ºftenDatei,
kanneinestarkeVarianzinnerhalbderDateienb eidenAngriswellenfestgestellt
werden.Abbildung 20 zeigtdieAnzahlderunterschiedlichenMicrosoftOce Do-
kumenteamTag√ºb ereinenl√§ngerenZeitraumhinweg.

InnerhalbdesAnsatzeswurdeb ewusstaufeinenselbstlernendenAlgorithmusver-
zichtet.EinTrainierendiesesAlgorithmusw√ºrdeaufgrundderkleinenDatenbasis
vonlegitimenMakro-Dokumentenerschwertwerden.Zus√§tzlichistdurchdenstati-


Abbildung20:AnzahldereindeutigenMalware-DokumenteamHoneyp ot-System
imMonatMai2016.Quelle:Autor

schenAnsatzf√ºrdieBewertungaucheineh√∂hereSicherheitgegenManipulationen
gegeb en.


## 5 Schlussb etrachtung

### 5.1 VergleichzuanderenAns√§tzen.

DiegenanntenAns√§tzesindsehrrudiment√§rundeinfachinderImplementierung.
Andere,meistkommerzielle,verfolgenandereWegef√ºrdieVerb esserungderErken-
nung.

Einer dieser kommerziellen Ans√§tzeist es, denFokus aufeine inder Cloudb e-
reitgestellteAnalyseplattformzulegen.DerSoftwareherstellerAvira^1 hatseinPro-
duktp ortfolio auf die neuen Bedrohungenvia E-Mailangepasst undbietet neue
M√∂glichkeitenzurAnalysevonDateieno derE-Mailsindervonihnenb etrieb enen
Cloud. Hierb eiwerden b ei einernegativeno der ausbleib endenBefundeiner Da-
teidurchdenlokalenErkennungsalgorithmusdiesezurerweitertenAnalyseineine
Cloudgesendet.InnerhalbdieserCloudwerdendannintelligentereundaufw√§ndigere
Analyseverfahrenangewendet,umdieDateizuklassizieren.

AndereAns√§tze verfolgeneine Verhaltensanalyseder Malware-Programmedurch
dasAusf√ºhreninSandb oxeno deranderenabgeschlossenenContainerinfrastruktu-
ren[32, S.93]und[5,S.4].DerHerstellervonE-Mail-Filter Proofpoint^2 bietet
diesenDienstauchinnerhalbeinerCloud-Ls√∂ungan.Hierb eiwirdderAnhangeiner
E-Mailno chzus√§tzlichaufunterschiedlichenBetriebssystemenvirtuellinderCloud
ausgef√ºhrtunddieVerhaltensweisederSchadsoftwareanalysiert.SokanneineVer-
haltensanalysedurchgef√ºhrtwerdenundeswirddab eidynamischb ewertet,obdie
DateieineGefahrdarstellto dernicht.

(^1) https://www.avira.de
(^2) https://www.pro ofp oint.com/


Beib eidenVorgehensweisen,kannb eiderschnellwechselndeMalware-Bedrohung
einLaufzeitproblementstehen.EineAnalysederDatenmussinjedemunb ekann-
tenFalldurchgef√ºhrtwerden.Dasb edeutet,dassjedeDatei,diedenE-Mailserver
passiert,p otentiellalsBedrohunggesehenwerdenmuss.Somitwirdjede,demFil-
terlokalunb ekannteDateiindieCloudgesendetunduntersucht.Darauskanneine
DurchlaufzeitdesAnhangvonbiszusechsMinuten(imFallProofpoint)entstehen,
bisdieAnalyseeinErgebnisermittelthat.WiedieErhebungausKapitel4.2.2b e-
st√§tigt,werdenzu88%nurDokumenteversendet.Dokumentehab endurcheinfaches
Ver√§nderndesTexteseinesehrschnelle√Ñnderungscharakteristik(sieheAbbildung
20).SeitFebruar 2016 konntenimHoneyp ot-Systemrund1.030grundlegendunter-
schiedlicheMakrob ehafteteDokumenteregistriertwerden.WieguteinFilterdieser
ArtmitderMasseanDokumentenumgehenkann,giltesno chzuanalysieren.Frag-
lichist,obesinBezugzumDatenschutzhierb eino cheineFragestellungzukl√§ren
gibt.

ImkommerziellenUmfeldistindenn√§chstenJahreneineFokussierung aufdiese
Cloud-undSandb ox-L√∂sungenzuerwarten.Marktf√ºhrendeHerstellerwieCisco^3 ,
Fireeye^4 undProofpoint^5 sindhierb eischonmitentsprechendenPro duktenvertre-
ten.

ImGebietderSpam-VerhinderunggibtesweitreichendeArb eitenimBereichder
k√ºnstlichenIntelligenz.Hierkanndurchentsprechendetextverarb eitendeAlgorith-
men einehoheundkorrektereErkennungerzeugtwerden[10, S.7].EineDurch-
dringendieserTechnologieindiePro duktef√ºrkleinebismittlereUnternehmenist
erstindenkommendenMonatenzuerwarten.Zumeistwerdendieseno chaufgrund
derRechenkapazit√§tinGro√øsystemenwieGoogleMail^6 o derMicrosoftOce 3657
eingesetzt[45,S.1].

EinweitererundschonaktivgenutzterAnsatzistes,LinksinSpam-E-Mails√ºb er
einezentraleDatenbankzuklassizieren.HierzuwirddieseDatenbankvoneinem
intelligentenAlgorithmusb ef√ºllt,derdynamischanalysierenkann,obessichb eider
VerlinkungumeineMalware-o derPhishing-Seitehandelt.Eineb ekannteQuellef√ºr

(^3) https://www.cisco.com/
(^4) https://www.reeye.com/
(^5) https://www.pro ofp oint.com/
(^6) https://mail.go ogle.com/
(^7) https://pro ducts.oce.com/en/business/explore-oce-365-for-business


solcheDatenisthierdieGoogleSafeBrowsing^8 Datenbank.

### 5.2 Zusammenfassung.

DieseArb eitstellteinenrepr√§sentativenAusgangszustandvonMailinfrastrukturen
inkleinenmitmittlerenUnternehmendar. Durchdie Analyseder Messergebnis-
sekonntensoinBezugaufdieneue Bedrohungslageneue Konzepteausgebreitet
werden. DiePro jektionderneuenAns√§tzeaufdieAusgangsmessdatenstellteine
AussichtaufdiegenerelleEzienzderErkennungdar.

Diegenannten0,27%(sieheAbbildung21),dienichtvom Malware-Filtererkannt
wurden,sindtrotzihrerUnscheinbarkeiteineb eachtlicheZahl.InSummesinddies
91 Nachrichten,wovonin 83 F√§llenauchnichtvomSpam-Filterklassiziertworden
sind,was 83 maleinequalitativho chwertigeBedrohungf√ºrdieAnwenderausmacht.
Das Infektionsrisiko,das vondiesen Anh√§ngenausgehtist,wie ermittelt,inden
ersten 24 Stundensehrho ch.

```
Abbildung21:AnteildervomMacroMiltererkanntenMalware.Quelle:Autor
```
ImBereichderVerhinderungvonSpamkonntediesmiteinfachenundvorhande-
nen Mitteln dargestellt werden. Essindhierzu keine weiterenkomplexen Imple-
mentierungenn√∂tig.Durchdieselbst√§ndigeErweiterungderDatenbankmitallen

(^8) https://develop ers.go ogle.com/safe-browsing/


ausgehendenE-MailabsendernentstehteinselbstlernendesSystem.Som√ºssenkeine
sp eziellenWartungeno derandereAktualisierungenvorgenommenwerden,umeine
gleichbleib endezienteErkennungzugew√§hrleisten.

Auchgro√øe Internetrmen wieGoogle hab enangefangen,intelligentereFilterme-
tho denzuentwickelnundeinzusetzen[38,S.3].Diesezeitgem√§√øeArt,vonzumeist
kombiniertenFiltermetho den,sollMalwareundSpamaufeineneueArterkennen
undverhindern[36,S.9].InvielenF√§llensindb eidieserVorgehensweisevonEr-
kennungssystemenjedo cheinegr√∂√øereRechenkapazit√§tundlaufendeOptimierun-
generforderlich,wasb eieinemkleinerenUnternehmenausKosten-undKnowHow-
Gr√ºndennichtumsetzbarist.

Sowohl die Erkenntnisse aus dieser Arb eit, als auch die von S. Kumar und S.
Arumugam[25,S.878]zeigen, dassklassischenMetho den derAnalysevonSpam
o derMalwarekeineausreichendeSicherheitmehrbietenk√∂nnen.NeueErkennungs-
metho de sind in naher Zukunft f√ºr eine weitere Sicherheitsoptimierung von E-
Mailinfrastrukturennotwendig.HierzusinddieunterschiedlichstenAns√§tzedenk-
bar.InvielenF√§llenmussmiteinererh√∂htenRechen-undDatenkapazit√§tf√ºrdie
Filterunggerechnetwerden.DieseArb eitzeigt,dassauchmiteinfachemundintelli-
gentemAuswertenvonschonvorhandenInformationeneineErh√∂hungderGesamt-
sicherheiterreichtwerdenkann.UmdieszuerreichensindkeineGro√ørechnersystem
notwendig,sondernesreichtaus,einigeOptimierungendervorhandenInfrastruk-
turvorzunehmen. DieEntwicklung undder Einsatzdes MacroMilter zeigt diese
M√∂glichkeitentsprechenddeutlichauf.

### 5.3 Diskussion

Die erw√§hnten kommerziellen Anti-Malware-Pro dukteund Technologien sindim
Bereich des Mittelstandsundin Konzernen sicherlicheine guteErweiterung der
SicherheitsinfrastrukturvonE-Mailsystemen.Jedo chgiltesdiesenAnsatzkritisch
inBezugaufdieEzienzunddesDatenschutzeszub etrachten.W√§hrendderEr-
stellungderArb eitwurdemitzweif√ºhrendenHerstellernvonAnti-Malware-und
Anti-Spam-L√∂sungendiskutiert.Imb eidenF√§llen,b eiderBetrachtungdesCloud-,
alsauchSandb ox-Ansatzes,istsomitdieFrageoen,obdieErkennungsgeschwindig-
keitenundErkennungsratenderMalwareundSpam-E-Mailsimpro duktivenAlltag


√ºb erhauptsignikantgesteigertwerdenk√∂nnen.

EinegrundlegendeVerb esserungderb eidenWertewirdhierb einichtinfragegestellt,
jedo chobdieVerh√§ltnism√§√øigkeitdesVorgangesinBezugaufdenMehrwertzielf√ºh-
rendist.Zub eachtengiltes,dassinnaherZukunftauchandereWegederVerteilung
vonMalware-Entwicklergenutztwerdenk√∂nnten.Kan√§lef√ºrdieVerbreitungk√∂nn-
tenhierMessagingPro duktewieWhatsApp^9 o derSkype^10 sein.Beideverf√ºgen√ºb er
dieM√∂glichkeiten,Linkso derDateienzuversenden.DerzeitsindmehreredemAu-
torb ekannteKonzerndab ei,eine EvaluierungdieserneuenKommunikationswege
durchzuf√ºhren.Zielsolleshiersein,dieseindenpro duktivenGesch√§ftsablaufzu
integrieren.EsstelltsichdanndieFrage,wieinnerhalbdieserzeitkritischenBerei-
chedieFiltermetho dendieZustellung verhindernk√∂nnen.EineDurchlaufzeitder
FilterungmitrundsechsMinutenproAnhangisthiernichtmehrm√∂glich.

EventuellistdasBlo ckierenvonAnh√§ngen,wieGoogleesb ereitserkannthat,die
letzteMetho de, Malwarezuvermeiden.Linksjedo ch, wirdmannicht so einfach
verbietenk√∂nnen.

Oen b eleibtauch dieFrage nach dem Datenschutz b ei einerEinsendung jedes
DokumentsineineClouddesAnti-MalwareAnbieters.PraktischwirdjederAnhang
durcheine,vomBenutzernichteinsehbare,Infrastrukturgeschleust.

Verschl√ºsselungimE-Mailverkehr

EinefundamentaleVerb esserungdesgesamtenE-MailverkehrsdurchdasKonzept
derob jektbasierterEnde-zu-Ende-Verschl√ºsselungistfraglich[23,S.390].InBe-
zugauf SpamundMalwarew√ºrde diesesVorgehen nur den Vorteil bieten, dass
derAbsendernichtmehraufeinfacheWeisegef√§lschtunddieNachrichtnurvom
Empf√§ngergelesen werdenkann.Hierdurchkann ab er eineserverseitigeFilterin-
stanzdieseNachricht nichtmehruntersuchen, dasiediesenurimverschl√ºsselten
Zustandb ereitgestelltb ekommt.SokanneinMalware-VersenderseineNachrichtmit
einemggf.gestohlenenZertikatverschl√ºsselnundkeinerderAnti-Malware-o der
Anti-Spam-Filterk√∂nntensieaufdieseMerkmalehinuntersuchen.Zus√§tzlichwird
demBenutzerdurchdieseVerschl√ºsselungeinescheinbareLegitimit√§tderNachricht
vorget√§uscht,waseineInfektiondramatischerh√∂henk√∂nnte.

(^9) https://www.whatsapp.com/
(^10) https://www.skyp e.com/en/


MitdemFokusaufMalware-undSpam-Bek√§mpfungsindhierb eino cheinige√úb er-
legung zutreen, wieeineVerschl√ºsselungeektiv undrichtigeingesetztwerden
kann.EinereineSignierungf√ºrdenSchutzderIntegrit√§tw√§rehierzumindestein
guterEinstiegspunkt.

### 5.4 Weiterf√ºhrendeArb eit

UmeineAussage √ºb erdieEzienzderb eiden Ans√§tzezuerhalten,sindweiter-
f√ºhrendeAnalysenundAuswertungenn√∂tig.DurchdiezeitlicheBegrenzungdieser
Arb eit wareine allgemeing√ºltigeundaussagekr√§ftigereBewertungnicht m√∂glich.
Denno chwurdezweiAns√§tzef√ºreineschnelleundezienteFilterunggezeigt.

Weiterf√ºhrend ist der Ansatz zur Verhinderung von Spam in einer praktischen
Anwendungzub etrachten.EinekonkreteImplementierungw√§rehieralsn√§chster
Schrittzusehen.EinenachgelagerteLangzeitanalyseisteb ensoangedacht,umdie
Ezienzgenauerzub etrachten.

ImBereichderVerhinderungvonMakro-MalwarewurdeschoneinekonkreteIm-
plementierungdurchgef√ºhrt.Hierb eiwurdederMacroMilterentwickelt,dersichan
demdargestelltenAnsatzorientiert.DurchdieBetrachtungderMessergebnissedes
Filterssolldieserweiterhinoptimiertwerden.

### 5.5 Danksagung

AndieserStellem√∂ chteichmichzun√§chstb eimeinenb eidenBetreuernHerrenProf.
Dr.MartinGoikundBenjaminKennerf√ºrdasVertrauenunddieM√∂glichkeitf√ºr
dieseArb eitdanken.Zus√§tzlichm√∂ chteichmeinKollegePeter Schiekf√ºrseinen
InputundGedankensto√øf√ºrdiesesThemadanken.

UndzuletztgiltderDankmeinerlieb enAlexsowieFreundenundFamilief√ºrihre
GeduldundHilfe.OhnedieseUnterst√ºtzungw√§reichnicht andieserZeileange-
langt.

```
Danke!
```

## Glossar

Base64 isteine8-BitKo dierungf√ºrBin√§rdaten.

BitCoin isteineneuartigeW√§hrungundwurde 2008 dasersteMalerw√§hnt.Hierb ei
handeltessichumeineselbstregulierendeW√§hrung,dienichtvonBankenge-
steuertwird.Angeb otundNachfrageb eeinussenhierdenKurs.Durchseine
kryptographischenEigenschaften istdieZahlungsmetho debiszurUmwand-
lungin√∂entlichgehandeltenW√§hrungenanonym.

Cloud steht f√ºrdas englischeWort Wolke undwirdinder ITalsSynonym f√ºr
verteiltes RechnenvonDaten verwendet.AnbietersolcherRechnerverb√§nde
sindz.B.MicrosftAzure^11 o derAmazonWebServices^12.

Dropp er AlsDropp erwirdeineMalwareb ezeichnetdienurdieAufgab ehat,andere
MalwarenachzuladenundaufdemSystemzuinstallieren.

False-Negativ stelltdasGegenteilvonFalse-Positivedar.EineErkennungvonMal-
wareo der Spambleibhierb eidurchdenFilter ausunddieNachricht wird
f√§lschlicherWeisezugestellt.

FullyQualiedDomainNameDieseBezeichnungstellteinenvollst√§ndigenName
einesSystemso derEndpunktesimNetzwerkdar.

Ham DasenglischeWortf√ºrSchinkenwirsinnbildlichf√ºreinegutartigeundge-
wollteE-Mailverwendet.HamstelltdasGegenteilvonSpamdar.

(^11) https://azure.microsoft.com/en-us/
(^12) https://aws.amazon.com/


Hash EinHashisteinemathematischeEinwegfunktion.Sieerstellteineneindeu-
tigen Wert√ºb er eineb eliebigeMengedar.Die gleicheMenge ergibtimmer
denselb en Hash-Wert. EinR√ºckschluss vom Hash-Wert aufdie Ursprungs-
mengeistnichtm√∂glich.BekannteAlgorithmensindhierMD5,SHA-1o der
SHA-256.

Junk wirdalsSynonymf√ºrSpamverwendet.

MailDeliveryAgent DieserServer-Typistf√ºrdieZustellungundVerwaltungder
Benutzer-Mailb oxenzust√§ndig.

MailTransferAgent EinMailTransferAgentisteineE-Mailserver-Komp onenten,
welcherf√ºrdenEmpfang,d√ºrdieVerarb eitungundanschlie√øendeWeiterlei-
tungeinerE-Mailzust√§ndigist.H√§ugwerdendieseMTAsmitFilteraufga-
b envertrautundsorgenalsersteInstanzvordemeigentlichenzustellenden
E-Mailserver,f√ºreineLastreduzierung.ErstelltkeineE-Mailsdirektanden
Benutzerzusonder√ºb ermitteltandenMDA,derdanndieseAufgab e√ºb er-
nimmt.

Milter stehtf√ºrMail-FilterundwirdimBezugaufdenPostx verwendet.Hier-
b ei handeltessichum einevom Postx b ereitgestellteSchnittstellef√ºrdie
AnbindungweitererMail-Filter.

Multipurp oseInternetMailExtensions DieMultipurposeInternetMailExtensi-
onsbietendieM√∂glichkeitKommunikationsdateninTextformabzubilden.Sie
werden innerhalbdesSMTP verwendet.DiesetextuelleDarstellungvon E-
Mailsb einhaltetAnh√§nge,denTextundalleweiterenMetainformationenwie
Absender,Empf√§nger,DatumundUhrzeitusw..

Phishing BeidieserArtvonAngrihandeltessichumdiekriminelleBeschaung
vonvertraulichenInformationendurchunterschiedlichsteMetho den.Einehier-
vonistz.B.dasf√§lscheneinervertrauensw√ºrdigenWebseiteumdasOpferdazu
zub ewegen,seineAnmeldedatenaufdieseranzugeb en.SokanneinAngreifer
entsprechendeInformationenabgreifen.

Port-Scan EinPort-ScanisteinVorgehen,b eidemeinAngreiferdurchProbieren
von Netzwerkp orts versucht,einen√úb erblick√ºb er dasSystemzu erhalten.


```
ZumeistwirdhierdurchdasSendeneinesNetzwerkpaketesversuchtheraus-
zunden,welchemNetzwerkdienstwelcherPortzugeordnetist.
```
Ransomware isteinAkronymausRansomundSoftware,wob eiRansomdasengli-
scheWortf√ºrErpressungist.SomitergibtsichausRansomwareeinedeutsche
√úb ersetzungvonErpresser-Software.

RequestForComments o derRFCisteinschriftlicheDarstellungeinerDiskussi-
on √ºb erunterschiedlicheVorgeheninderIT.Hierausentstehenimweiteren
VerlaufunterschiedlicheStandardisierungsvorlagenf√ºrz.B.Implementierun-
genvonInternetprotokollen.

Spam isturspr√ºnglichdieAbk√ºrzungf√ºrdasenglischeDoseneischSpicedHam.
Dieses wurdedurchseineOmnipr√§senzim KriegalsSinnbildf√ºrunn√∂tiges
und√ºb ertrieb enh√§ugesVorkommengenommen.InderInformationstechnik
wirddasWortf√ºrunerw√ºnschteE-Mailsverwendet,diezumeistungewollte
Werbungo derMalwarezumInhalthab en.

VisualBasicAccessisteineSp ezialisierungdesVisualBasic.Hierb eihandeltes
sich um eineProgrammiersprache, dievon Microsoftentwickelt wurde. Bei
der Sp ezialisierung handeltes ichumAnpassungen undErweiterungen f√ºr
MicrosoftOceDokumente.MitdieserSprachek√∂nnenkomplexeFunktionen
ineinDokumentintegriertwerden.


## Literatur

```
[1] Al les√ºber:Spam:E-Mailsicherundbenutzbarhalten.Bd.7.Linux-Magazin
Technicalreview.M√ºnchen:LinuxNewMedia,2008.isbn:9783939551096.
[2] Andrea Allievi und Holger Unterbrink.  CryptoWall4: The evolution con-
tinues. In: (2016). url: http : / / blog. talosintel. com / 2015 / 12 /
cryptowall- 4.html.
[3] IonAndroutsop oulos, John Koutsias,Konstantinos V. Chandrinos, George
PaliourasundConstantineD.Spyrop oulos.AnEvaluationofNaiveBayesian
Anti-SpamFiltering.2000.
[4] IonAndroutsop oulos,JohnKoutsias,KonstantinosV.ChandrinosundCon-
stantineD.Spyrop oulos.AnExperimentalComparisonofNaiveBayesianand
Keyword-BasedAnti-SpamFilteringwithPersonalE-mailMessages:Procee-
dingsofthe23rdAnnualInternationalACMSIGIRConferenceonResearch
andDevelopmentinInformationRetrieval.NewYork,N.Y.:Asso ciationfor
ComputingMachinery,2000.isbn:9781581132267.
[5] Ulrich Bayer, Paolo Milani Comparetti, Clemens Hlauschek, Christopher
KruegelundEnginKirda.Scalable,Behavior-BasedMalwareClustering.
[6] BayerischePolizei,Hrsg.Erpressungs-TrojaneraufServereinerStadtverwal-
tung  Kripo ermittelt. 2016. url: https : / / www. polizei. bayern. de /
unterfranken/news/presse/aktuell/index.html/237562.
[7] EnricoBlanzieriundAntonBryl. Asurveyof learning-basedtechniquesof
emailspamltering.In:ArticialIntel ligenceReview 29.1(2008),S.6392.
issn:0269-2821.doi:10.1007/s10462- 009- 9109- 6.url:http://eprints.
biblio.unitn.it/1070/1/056.pdf.
```

[8] AndrewBrandt.AnatomyofaWordDocumentMacroMalwareAttack.Hrsg.
von Blue Coat Systems Inc. 2016. url: https : / / www. bluecoat. com /
security - blog / 2015 - 05 - 12 / anatomy - word - document - macro - malware -
attack.
[9] Bundesamtf√ºrSicherheitinderInformationstechnik.Ransomware -Bedro-
hungslage, Pr√§vention&Reaktion.Deutschland,2016.url: https : / / www.
bsi.bund.de/SharedDocs/Downloads/DE/BSI/Cyber- Sicherheit/Themen/
Ransomware.pdf?__blob=publicationFile&v=2.
[10] XavierCarrerasundLlu√¨sM√†rquez.BoostingTreesforAnti-SpamEmailFil-
tering.Barcelona,2001.
[11] ChiouPin-Ren,LinPo-ChingundLiChun-Ta. Blo ckingSpamSessionswith
Greylisting and Blo ckListing basedon Client Behavior.In: (2012).url:
http : / / citeseerx. ist. psu. edu / viewdoc / download? doi = 10. 1. 1. 401.
3018&rep=rep1&type=pdf.
[12] ZakirDurumeric,J.Alex Halderman, DavidAdrian, ArianaMirian, James
Kasten,ElieBursztein,NicolasLidzb orski,KurtThomas,VijayErantiund
MichaelBailey. NeitherSnowNorRainNorMITM.In:the 2015 ACMCon-
ference.Hrsg.vonKenjiroCho,KensukeFukuda,VivekPaiundNeilSpring,
S.2739.doi:10.1145/2815675.2815695.
[13] Ronald Eikenb erg. Neue Masche: Krypto-Trojaner Locky √ºber Javascript-
Dateien verbreitet. Hrsg. von HeiseMedien GmbH & Co.KG. 2016.url:
[http://heise.de/-](http://heise.de/-) 3113689.
[14] Ronald Eikenb erg und Schmidt J√ºrgen.  To janer auf Raubzug:
Verschl√ºsselungs-Malwareanalysiert.In:c'tmagazinf√ºrcomputertechnik 7
(2016),S.8687.
[15] MarkusEngelb erth. So cialMalco de:Benutzerabh√§ngigeSchadprogramme.
Dissertation. Mannheim:Universit√§t Mannheim, 2013.url: http : / / ub -
madoc.bib.uni- mannheim.de/34511/1/promotionsarbeit.pdf.
[16] Federal Bureauof Investigation, Hrsg.Criminals Continueto Defraud and
Extort Funds from Victims Using CryptoWal l Ransomware Schemes. 2015.
url:https://www.ic3.gov/media/2015/150623.aspx.
[17] ThomasFox-Brewster.AsRansomware CrisisExplodes,Hol lywood Hospital
CoughsUp$17,000 InBitcoin.Hrsg.vonForb es.2016.url:http : / / www.
forbes.com/sites/thomasbrewster/2016/02/18/ransomware- hollywood-
payment- locky- menace.


[18] AlexandreGazet. Comparativeanalysisofvariousransomwarevirii.In:Jour-
nalinComputerVirology6.1(2010),S.7790.issn:1772-9890.doi:10.1007/
s11416- 008- 0092- 2.
[19] PaulGraham.APlanforSpam.2002.url:http : / / www. paulgraham. com /
spam.html.
[20] K. Harrenstien,M. StahlundE. Feinler.RFC 952. 1985.url:https : / /
tools.ietf.org/html/rfc952.
[21] HansIrlacher.AdvancedThreatProtection.31.03.2016.
[22] AxelKannenb erg.Ransomware:US-Krankenhauszahlt 40 BitcoinsL√∂segeld.
Hrsg.vonHeiseMedienGmbH&Co.KG.2016.url:http : / / heise. de/ -
3109956.
[23] WalterKrihaundRolandSchmitz.SichereSysteme:Konzepte,Architekturen
undFrameworks. Xp ert.press.Berlin: Springer,2009.isbn:9783540789581.
doi:10.1007/978- 3- 540- 78959- 8.
[24] MurrayS.KucherawyundDaveCro cker.RFC 6647:EmailGreylisting:An
ApplicabilityStatementfor SMTP.2012.url:https : / / tools. ietf. org /
html/rfc6647.html.
[25] S.KumarundS.Arumugam. AProbabilisticNeuralNetworkBasedClassi-
cationofSpamMailsUsingParticleSwarmOptimizationFeatureSelection.
In:Midd le-East JournalofScienticResearch 23 (2015),S.874879.url:
[http://idosi.org/mejsr/mejsr23%285%2915/17.pdf.](http://idosi.org/mejsr/mejsr23%285%2915/17.pdf.)
[26] Philipp eLagadec.8KBofmalwarecrammedintoasinglecommandlineina
macro.2016.url:http://www.decalage.info/en/8KB_oneliner.
[27] WilliamLargent.Ransomware: Past,Present, andFuture. Hrsg.von Cisco
Systems.2016.url:http : / / blog. talosintel. com / 2016 / 04 / ransomware.
html.
[28] GunnarLindb erg.Anti-SpamRecommendationsforSMTPMTAs.Hrsg.von
IETF.1999.url:https://tools.ietf.org/html/rfc2505.
[29] MicrosoftMalwareProtection Center,Hrsg.Newfeature inOce 2016 can
blockmacrosandhelppreventinfection.2016.url:https://blogs.technet.
microsoft. com / mmpc / 2016 / 03 / 22 / new - feature - in - office - 2016 - can -
block- macros- and- help- prevent- infection/?platform=hootsuite.
[30] Microsoft,Hrsg.MalwareProtectionCenter:Macromalware:Summary.2015.
url: http : / / download. microsoft. com / download / A / E / 5 / AE546268 -


519C- 4A7E- 8EC4- 9EE29A80B79D/MMPC%20Threat%20Intelligence%20July%
202015.pdf.
[31] FabioPagani,MatteoDeAstis,MarianoGraziano,AndreaLanziundDavide
Balzarotti.MeasuringtheRoleofGreylistingandNolistinginFightingSpam.
[32] Rob ertoPaleari. Dealingwithnext-generationmalware.Dissertation.Mai-
land:Universit√§tMailand,2011.
[33] Norb ert Pohlmann.  Bedrohungen und Herausforderungen des E-Mail-
Dienstes:DieSicherheitsrisikendesE-Mail-DienstesimInternet.In:Daten-
schutzundDatensicherheit-DuD 34.9(2010),S.607613.issn:1614-0702.
doi:10.1007/s11623- 010- 0145- 9.
[34] Pro ofp oint, Hrsg. HumanFactor Report 2016. 2016. url: https : / / www.
proofpoint.com/us/human- factor- report- 2016.
[35] NielsProvos,Dean McNamee,PanayiotisMavrommatis,KeWang undNa-
gendraMo dadugu.TheGhostInTheBrowser:AnalysisofWeb-basedMal-
ware.Hrsg.vonGo ogleInc.doi: 10. 1787 / 578054332028.url:https : / /
www. usenix. org / legacy / events / hotbots07 / tech / full _ papers / provos /
provos.pdf.
[36] MoheebAbuRa jab,LucasBallard,No√®Lutz,PanayiotisMavrommatisund
NielsProvos.CAMP:Content-AgnosticMalwareProtection.Hrsg.vonGo ogle
Inc.
[37] PeterW.Resnick.InternetMessageFormat:RFC 2822 .2001.url:https :
//www.ietf.org/rfc/rfc2822.txt.
[38] KonradRieck,PhilippTrinius,CarstenWillemsundThorstenHolz. Auto-
maticAnalysisofMalwareBehaviorusingMachineLearning.In:IOSPress
(2011).
[39] S. Ritterbusch.Die Mathematik des Bayes Spamlters.Hrsg. von Karlsru-
her Institut f√ºrTechnologie. url: http : / / www. math. kit. edu / ianm4 /
~ritterbusch/seite/spam/de.
[40] HenryStern,JustinMasonundShepherdMichael.ALinguistics-BasedAttack
onPersonalisedStatisticalE-mailClassiers:TechnicalReport CS-2004-06.
2004.url:https : / / www. cs. dal. ca / sites / default / files / technical _
reports/CS- 2004- 06.pdf.
[41] Symantec Corp oration, Hrsg. Security Response Publications. 2016. url:
https : / / www. symantec. com / security _ response / publications /
monthlythreatreport.jsp#Spam.


[42] TheApacheSoftwareFoundation,Hrsg.TheApacheSpamAssassinProject:
TestsPerformed:v3.2.x.2014.url:https : / / spamassassin. apache. org /
tests_3_2_x.html.
[43] TheRadicatiGroupInc.,Hrsg.EmailStatisticsReport2015-2019.2015.url:
http : / / www. radicati. com / wp / wp - content / uploads / 2015 / 02 / Email -
Statistics- Report- 2015- 2019- Executive- Summary.pdf.
[44] J√∂rgThoma."Antivirensoftwareisttot".Hrsg.vongolem.de.2014.url:http:
/ / www. golem. de / news / symantec - antivirensoftware - ist - tot - 1405 -
106251.html.
[45] KurtThomas,ChrisGrier,JustinMa,VernPaxsonundDawnSong. Design
andEvaluationofaReal-TimeURLSpamFilteringService.In: 2011 IEEE
Symposium onSecurity andPrivacy(SP), S.447462.doi: 10. 1109 / SP.
2011.25.
[46] IvoTruxa. TheAuto-WhiteList.2014.url: https : / / wiki. apache. org /
spamassassin/AutoWhitelist.
[47] GregoryM.Vaudreuil.EnhancedMailSystemStatusCodes:RFC 3463 .2003.
url:https://tools.ietf.org/html/rfc3463.
[48] MichaelVeit.Sofortma√ønahmengegenKrypto-Trojaner:EinSophosWhitepa-
per. Hrsg. von SophosLtd. 2016.url: https : / / www. sophos. com / de -
de / medialibrary / Gated % 20Assets / white % 20papers / Sophos - emergency -
measures- against- crypto- Trojan- wp.pdf.
[49] Verizon, Hrsg.Data Breach Investigations Report 2016. 2016. url: http :
//www.verizonenterprise.com/verizon- insights- lab/dbir/2016/.
[50] Verizon,Hrsg.Data BreachInvestigations Rreport 2015. 2015.url:http :
/ / www. verizonenterprise. com / resources / reports / rp _ data - breach -
investigation- report_2015_en_xg.pdf.
[51] Wikip edia,Hrsg.NaiveBayesspamltering.url:https : / / en. wikipedia.
org/wiki/Naive_Bayes_spam_filtering.
[52] Wikip edia, Hrsg. Phishing. url: https : / / de. wikipedia. org / wiki /
Phishing.
[53] p ostx.org, Hrsg. Postxbefore-queue Milter support. url: http : / / www.
postfix.org/MILTER_README.html.